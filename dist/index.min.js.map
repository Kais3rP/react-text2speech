{"version":3,"file":"index.min.js","sources":["../node_modules/@react-icons/all-files/lib/esm/iconContext.js","../node_modules/@react-icons/all-files/lib/esm/iconBase.js","../node_modules/@react-icons/all-files/lib/esm/iconsManifest.js","../node_modules/@react-icons/all-files/ai/AiFillFastBackward.js","../node_modules/@react-icons/all-files/ai/AiFillFastForward.js","../node_modules/@react-icons/all-files/ai/AiFillPlayCircle.js","../node_modules/@react-icons/all-files/ai/AiFillPauseCircle.js","../node_modules/@react-icons/all-files/bi/BiReset.js","../src/store/actions.ts","../src/contexts/contexts.ts","../node_modules/tslib/tslib.es6.js","../src/lib/Utils.ts","../src/lib/SpeechSynth.ts","../src/store/index.ts","../src/contexts/hooks.ts","../src/contexts/providers.tsx","../node_modules/style-inject/dist/style-inject.es.js","../src/components/MainControls/MainControls.tsx","../node_modules/@react-icons/all-files/fi/FiMaximize.js","../node_modules/@react-icons/all-files/fi/FiMinimize.js","../node_modules/@react-icons/all-files/md/MdClose.js","../src/components/WindowControls/WindowControls.tsx","../src/components/SeekBar/SeekBar.tsx","../src/hooks/index.ts","../src/components/CustomSelect/Button.tsx","../src/components/CustomSelect/CustomSelect.tsx","../node_modules/@react-icons/all-files/bi/BiVolumeFull.js","../src/components/GenericSlider/GenericSlider.tsx","../node_modules/@react-icons/all-files/fc/FcSettings.js","../src/components/Options/Options.tsx","../src/components/SecondaryControls/SecondaryControls.tsx","../src/components/TextReader/hooks.tsx","../src/components/TextReader/TextReader.tsx","../src/index.tsx"],"sourcesContent":["import React from 'react';\nexport var DefaultContext = {\n  color: undefined,\n  size: undefined,\n  className: undefined,\n  style: undefined,\n  attr: undefined\n};\nexport var IconContext = React.createContext && React.createContext(DefaultContext);","var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport React from 'react';\nimport { IconContext, DefaultContext } from './iconContext';\n\nfunction Tree2Element(tree) {\n  return tree && tree.map(function (node, i) {\n    return React.createElement(node.tag, __assign({\n      key: i\n    }, node.attr), Tree2Element(node.child));\n  });\n}\n\nexport function GenIcon(data) {\n  return function (props) {\n    return React.createElement(IconBase, __assign({\n      attr: __assign({}, data.attr)\n    }, props), Tree2Element(data.child));\n  };\n}\nexport function IconBase(props) {\n  var elem = function (conf) {\n    var attr = props.attr,\n        size = props.size,\n        title = props.title,\n        svgProps = __rest(props, [\"attr\", \"size\", \"title\"]);\n\n    var computedSize = size || conf.size || \"1em\";\n    var className;\n    if (conf.className) className = conf.className;\n    if (props.className) className = (className ? className + ' ' : '') + props.className;\n    return React.createElement(\"svg\", __assign({\n      stroke: \"currentColor\",\n      fill: \"currentColor\",\n      strokeWidth: \"0\"\n    }, conf.attr, attr, svgProps, {\n      className: className,\n      style: __assign(__assign({\n        color: props.color || conf.color\n      }, conf.style), props.style),\n      height: computedSize,\n      width: computedSize,\n      xmlns: \"http://www.w3.org/2000/svg\"\n    }), title && React.createElement(\"title\", null, title), props.children);\n  };\n\n  return IconContext !== undefined ? React.createElement(IconContext.Consumer, null, function (conf) {\n    return elem(conf);\n  }) : elem(DefaultContext);\n}","export var IconsManifest = [\n  {\n    \"id\": \"fa\",\n    \"name\": \"Font Awesome\",\n    \"projectUrl\": \"https://fontawesome.com/\",\n    \"license\": \"CC BY 4.0 License\",\n    \"licenseUrl\": \"https://creativecommons.org/licenses/by/4.0/\"\n  },\n  {\n    \"id\": \"io\",\n    \"name\": \"Ionicons 4\",\n    \"projectUrl\": \"https://ionicons.com/\",\n    \"license\": \"MIT\",\n    \"licenseUrl\": \"https://github.com/ionic-team/ionicons/blob/master/LICENSE\"\n  },\n  {\n    \"id\": \"io5\",\n    \"name\": \"Ionicons 5\",\n    \"projectUrl\": \"https://ionicons.com/\",\n    \"license\": \"MIT\",\n    \"licenseUrl\": \"https://github.com/ionic-team/ionicons/blob/master/LICENSE\"\n  },\n  {\n    \"id\": \"md\",\n    \"name\": \"Material Design icons\",\n    \"projectUrl\": \"http://google.github.io/material-design-icons/\",\n    \"license\": \"Apache License Version 2.0\",\n    \"licenseUrl\": \"https://github.com/google/material-design-icons/blob/master/LICENSE\"\n  },\n  {\n    \"id\": \"ti\",\n    \"name\": \"Typicons\",\n    \"projectUrl\": \"http://s-ings.com/typicons/\",\n    \"license\": \"CC BY-SA 3.0\",\n    \"licenseUrl\": \"https://creativecommons.org/licenses/by-sa/3.0/\"\n  },\n  {\n    \"id\": \"go\",\n    \"name\": \"Github Octicons icons\",\n    \"projectUrl\": \"https://octicons.github.com/\",\n    \"license\": \"MIT\",\n    \"licenseUrl\": \"https://github.com/primer/octicons/blob/master/LICENSE\"\n  },\n  {\n    \"id\": \"fi\",\n    \"name\": \"Feather\",\n    \"projectUrl\": \"https://feathericons.com/\",\n    \"license\": \"MIT\",\n    \"licenseUrl\": \"https://github.com/feathericons/feather/blob/master/LICENSE\"\n  },\n  {\n    \"id\": \"gi\",\n    \"name\": \"Game Icons\",\n    \"projectUrl\": \"https://game-icons.net/\",\n    \"license\": \"CC BY 3.0\",\n    \"licenseUrl\": \"https://creativecommons.org/licenses/by/3.0/\"\n  },\n  {\n    \"id\": \"wi\",\n    \"name\": \"Weather Icons\",\n    \"projectUrl\": \"https://erikflowers.github.io/weather-icons/\",\n    \"license\": \"SIL OFL 1.1\",\n    \"licenseUrl\": \"http://scripts.sil.org/OFL\"\n  },\n  {\n    \"id\": \"di\",\n    \"name\": \"Devicons\",\n    \"projectUrl\": \"https://vorillaz.github.io/devicons/\",\n    \"license\": \"MIT\",\n    \"licenseUrl\": \"https://opensource.org/licenses/MIT\"\n  },\n  {\n    \"id\": \"ai\",\n    \"name\": \"Ant Design Icons\",\n    \"projectUrl\": \"https://github.com/ant-design/ant-design-icons\",\n    \"license\": \"MIT\",\n    \"licenseUrl\": \"https://opensource.org/licenses/MIT\"\n  },\n  {\n    \"id\": \"bs\",\n    \"name\": \"Bootstrap Icons\",\n    \"projectUrl\": \"https://github.com/twbs/icons\",\n    \"license\": \"MIT\",\n    \"licenseUrl\": \"https://opensource.org/licenses/MIT\"\n  },\n  {\n    \"id\": \"ri\",\n    \"name\": \"Remix Icon\",\n    \"projectUrl\": \"https://github.com/Remix-Design/RemixIcon\",\n    \"license\": \"Apache License Version 2.0\",\n    \"licenseUrl\": \"http://www.apache.org/licenses/\"\n  },\n  {\n    \"id\": \"fc\",\n    \"name\": \"Flat Color Icons\",\n    \"projectUrl\": \"https://github.com/icons8/flat-color-icons\",\n    \"license\": \"MIT\",\n    \"licenseUrl\": \"https://opensource.org/licenses/MIT\"\n  },\n  {\n    \"id\": \"gr\",\n    \"name\": \"Grommet-Icons\",\n    \"projectUrl\": \"https://github.com/grommet/grommet-icons\",\n    \"license\": \"Apache License Version 2.0\",\n    \"licenseUrl\": \"http://www.apache.org/licenses/\"\n  },\n  {\n    \"id\": \"hi\",\n    \"name\": \"Heroicons\",\n    \"projectUrl\": \"https://github.com/refactoringui/heroicons\",\n    \"license\": \"MIT\",\n    \"licenseUrl\": \"https://opensource.org/licenses/MIT\"\n  },\n  {\n    \"id\": \"si\",\n    \"name\": \"Simple Icons\",\n    \"projectUrl\": \"https://simpleicons.org/\",\n    \"license\": \"CC0 1.0 Universal\",\n    \"licenseUrl\": \"https://creativecommons.org/publicdomain/zero/1.0/\"\n  },\n  {\n    \"id\": \"im\",\n    \"name\": \"IcoMoon Free\",\n    \"projectUrl\": \"https://github.com/Keyamoon/IcoMoon-Free\",\n    \"license\": \"CC BY 4.0 License\"\n  },\n  {\n    \"id\": \"bi\",\n    \"name\": \"BoxIcons\",\n    \"projectUrl\": \"https://github.com/atisawd/boxicons\",\n    \"license\": \"CC BY 4.0 License\"\n  },\n  {\n    \"id\": \"cg\",\n    \"name\": \"css.gg\",\n    \"projectUrl\": \"https://github.com/astrit/css.gg\",\n    \"license\": \"MIT\",\n    \"licenseUrl\": \"https://opensource.org/licenses/MIT\"\n  },\n  {\n    \"id\": \"vsc\",\n    \"name\": \"VS Code Icons\",\n    \"projectUrl\": \"https://github.com/microsoft/vscode-codicons\",\n    \"license\": \"CC BY 4.0\",\n    \"licenseUrl\": \"https://creativecommons.org/licenses/by/4.0/\"\n  }\n]","// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.AiFillFastBackward = function AiFillFastBackward (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"viewBox\":\"0 0 1024 1024\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M517.6 273.5L230.2 499.3a16.14 16.14 0 0 0 0 25.4l287.4 225.8c10.7 8.4 26.4.8 26.4-12.7V286.2c0-13.5-15.7-21.1-26.4-12.7zm320 0L550.2 499.3a16.14 16.14 0 0 0 0 25.4l287.4 225.8c10.7 8.4 26.4.8 26.4-12.7V286.2c0-13.5-15.7-21.1-26.4-12.7zm-620-25.5h-51.2c-3.5 0-6.4 2.7-6.4 6v516c0 3.3 2.9 6 6.4 6h51.2c3.5 0 6.4-2.7 6.4-6V254c0-3.3-2.9-6-6.4-6z\"}}]})(props);\n};\n","// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.AiFillFastForward = function AiFillFastForward (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"viewBox\":\"0 0 1024 1024\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M793.8 499.3L506.4 273.5c-10.7-8.4-26.4-.8-26.4 12.7v451.6c0 13.5 15.7 21.1 26.4 12.7l287.4-225.8a16.14 16.14 0 0 0 0-25.4zm-320 0L186.4 273.5c-10.7-8.4-26.4-.8-26.4 12.7v451.5c0 13.5 15.7 21.1 26.4 12.7l287.4-225.8c4.1-3.2 6.2-8 6.2-12.7 0-4.6-2.1-9.4-6.2-12.6zM857.6 248h-51.2c-3.5 0-6.4 2.7-6.4 6v516c0 3.3 2.9 6 6.4 6h51.2c3.5 0 6.4-2.7 6.4-6V254c0-3.3-2.9-6-6.4-6z\"}}]})(props);\n};\n","// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.AiFillPlayCircle = function AiFillPlayCircle (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"viewBox\":\"0 0 1024 1024\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm144.1 454.9L437.7 677.8a8.02 8.02 0 0 1-12.7-6.5V353.7a8 8 0 0 1 12.7-6.5L656.1 506a7.9 7.9 0 0 1 0 12.9z\"}}]})(props);\n};\n","// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.AiFillPauseCircle = function AiFillPauseCircle (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"viewBox\":\"0 0 1024 1024\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-80 600c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V360c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v304zm224 0c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V360c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v304z\"}}]})(props);\n};\n","// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.BiReset = function BiReset (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"viewBox\":\"0 0 24 24\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M12,16c1.671,0,3-1.331,3-3s-1.329-3-3-3s-3,1.331-3,3S10.329,16,12,16z\"}},{\"tag\":\"path\",\"attr\":{\"d\":\"M20.817,11.186c-0.12-0.583-0.297-1.151-0.525-1.688c-0.225-0.532-0.504-1.046-0.83-1.531 c-0.324-0.479-0.693-0.926-1.098-1.329c-0.404-0.406-0.853-0.776-1.332-1.101c-0.483-0.326-0.998-0.604-1.528-0.829 c-0.538-0.229-1.106-0.405-1.691-0.526c-0.6-0.123-1.219-0.182-1.838-0.18V2L8,5l3.975,3V6.002C12.459,6,12.943,6.046,13.41,6.142 c0.454,0.094,0.896,0.231,1.314,0.409c0.413,0.174,0.813,0.392,1.188,0.644c0.373,0.252,0.722,0.54,1.038,0.857 c0.315,0.314,0.604,0.663,0.854,1.035c0.254,0.376,0.471,0.776,0.646,1.191c0.178,0.417,0.314,0.859,0.408,1.311 C18.952,12.048,19,12.523,19,13s-0.048,0.952-0.142,1.41c-0.094,0.454-0.23,0.896-0.408,1.315 c-0.175,0.413-0.392,0.813-0.644,1.188c-0.253,0.373-0.542,0.722-0.858,1.039c-0.315,0.316-0.663,0.603-1.036,0.854 c-0.372,0.251-0.771,0.468-1.189,0.645c-0.417,0.177-0.858,0.314-1.311,0.408c-0.92,0.188-1.906,0.188-2.822,0 c-0.454-0.094-0.896-0.231-1.314-0.409c-0.416-0.176-0.815-0.393-1.189-0.645c-0.371-0.25-0.719-0.538-1.035-0.854 c-0.315-0.316-0.604-0.665-0.855-1.036c-0.254-0.376-0.471-0.776-0.646-1.19c-0.178-0.418-0.314-0.86-0.408-1.312 C5.048,13.952,5,13.477,5,13H3c0,0.611,0.062,1.221,0.183,1.814c0.12,0.582,0.297,1.15,0.525,1.689 c0.225,0.532,0.504,1.046,0.831,1.531c0.323,0.477,0.692,0.924,1.097,1.329c0.406,0.407,0.854,0.777,1.331,1.099 c0.479,0.325,0.994,0.604,1.529,0.83c0.538,0.229,1.106,0.405,1.691,0.526C10.779,21.938,11.389,22,12,22s1.221-0.062,1.814-0.183 c0.583-0.121,1.151-0.297,1.688-0.525c0.537-0.227,1.052-0.506,1.53-0.83c0.478-0.322,0.926-0.692,1.331-1.099 c0.405-0.405,0.774-0.853,1.1-1.332c0.325-0.483,0.604-0.998,0.829-1.528c0.229-0.54,0.405-1.108,0.525-1.692 C20.938,14.221,21,13.611,21,13S20.938,11.779,20.817,11.186z\"}}]})(props);\n};\n","import { ISettings, IOptions, IStyle } from 'lib/types';\r\n\r\nexport const createAction = (type: string, payload?: any): ActionType => ({\r\n\ttype,\r\n\tpayload,\r\n});\r\n\r\n/* Actions */\r\n\r\n/* Actions that might be used to control the Reader externally */\r\n\r\nexport const setIsReading = (payload: boolean) =>\r\n\tcreateAction('SET_IS_READING', payload);\r\n\r\nexport const setIsMinimized = (payload: boolean) =>\r\n\tcreateAction('SET_IS_MINIMIZED', payload);\r\n\r\nexport const setIsVisible = (payload: boolean) =>\r\n\tcreateAction('SET_IS_VISIBLE', payload);\r\n\r\n/* Actions used internally by the Reader  */\r\n\r\nexport const setIsLoading = (payload: boolean) =>\r\n\tcreateAction('SET_IS_LOADING', payload);\r\n\r\nexport const setIsOptionsVisible = (payload: boolean) =>\r\n\tcreateAction('SET_IS_OPTIONS_VISIBLE', payload);\r\n\r\nexport const setVoices = (payload: IVoiceInfo[]) =>\r\n\tcreateAction('SET_VOICES', payload);\r\n\r\nexport const setElapsedTime = (payload: number) =>\r\n\tcreateAction('SET_ELAPSED_TIME', payload);\r\n\r\nexport const setNumberOfWords = (payload: number) =>\r\n\tcreateAction('SET_NUMBER_OF_WORDS', payload);\r\n\r\nexport const setCurrentWordIndex = (payload: number) =>\r\n\tcreateAction('SET_CURRENT_WORD_INDEX', payload);\r\n\r\nexport const setDuration = (payload: number) =>\r\n\tcreateAction('SET_DURATION', payload);\r\n\r\nexport const changeSettings = (payload: Partial<ISettings>) =>\r\n\tcreateAction('CHANGE_SETTINGS', payload);\r\n\r\nexport const changeOptions = (payload: Partial<IOptions>) =>\r\n\tcreateAction('CHANGE_OPTIONS', payload);\r\n\r\nexport const changeHighlightStyle = (payload: Partial<IStyle>) =>\r\n\tcreateAction('CHANGE_HIGHLIGHT_STYLE', payload);\r\n","import React from 'react';\r\nimport { IStoreContext, IMainPropsContext, IReaderContext } from './types';\r\n\r\nexport const StoreContext = React.createContext<IStoreContext | null>(null);\r\n\r\nexport const MainPropsContext = React.createContext<IMainPropsContext | null>(\r\n\tnull\r\n);\r\n\r\nexport const ReaderContext = React.createContext<IReaderContext | null>(null);\r\n","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","export class Utils {\r\n\tHTMLTags: string[];\r\n\r\n\tconstructor() {\r\n\t\tthis.HTMLTags = [\r\n\t\t\t'div',\r\n\t\t\t'span',\r\n\t\t\t'a',\r\n\t\t\t'i',\r\n\t\t\t'img',\r\n\t\t\t'html',\r\n\t\t\t'body',\r\n\t\t\t'section',\r\n\t\t\t'article',\r\n\t\t\t'main',\r\n\t\t\t'head',\r\n\t\t\t'header',\r\n\t\t\t'aside',\r\n\t\t\t'nav',\r\n\t\t];\r\n\t}\r\n\r\n\tstatic isMobile() {\r\n\t\t/* Dev mode */\r\n\t\t//\treturn true;\r\n\t\t// check the user agent string\r\n\t\tif (\r\n\t\t\t/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\r\n\t\t\t\tnavigator.userAgent\r\n\t\t\t)\r\n\t\t)\r\n\t\t\treturn true;\r\n\r\n\t\t// check the platform string\r\n\t\tif (/iPad|iPhone|iPod/.test(navigator.platform)) return true;\r\n\r\n\t\t// check the screen size and pixel density\r\n\t\tif (window.innerWidth < 768 || window.devicePixelRatio > 1) return true;\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/* Regex Utils */\r\n\r\n\tstatic isSlashTextContent(str: string) {\r\n\t\tif (!str) return false;\r\n\t\treturn /<.+>\\/<\\/.+>/.test(str);\r\n\t}\r\n\r\n\tstatic isDigitTextContent(str: string) {\r\n\t\tif (!str) return false;\r\n\t\treturn /<.+>\\d+<\\/.+>/.test(str);\r\n\t}\r\n\r\n\tstatic isWordTextContent(str: string) {\r\n\t\tif (!str) return false;\r\n\t\treturn /<.+>[a-zA-Z]+<\\/.+>/.test(str);\r\n\t}\r\n\r\n\tstatic isWord(str: string) {\r\n\t\tif (!str) return false;\r\n\t\treturn /^[a-zA-Z]/.test(str);\r\n\t}\r\n\r\n\tstatic isWordWithNumbers(str: string) {\r\n\t\tif (!str) return false;\r\n\t\treturn /^[a-zA-Z0-9]+$/.test(str);\r\n\t}\r\n\r\n\tstatic isNumber(str: string) {\r\n\t\tif (!str) return false;\r\n\t\treturn (!isNaN(+str) && isFinite(+str)) || parseFloat(str);\r\n\t}\r\n\r\n\tstatic isURL(str: string) {\r\n\t\tif (!str) return false;\r\n\t\treturn /^https?:\\/\\/(?:www\\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b(?:[-a-zA-Z0-9()@:%_+.~#?&/=]*)$/.test(\r\n\t\t\tstr\r\n\t\t);\r\n\t}\r\n\r\n\tstatic isSpace(str: string) {\r\n\t\treturn str === ' ';\r\n\t}\r\n\r\n\tstatic isEmptyString(str: string) {\r\n\t\treturn str === '';\r\n\t}\r\n\r\n\tstatic isWhitespaceChar(str: string) {\r\n\t\treturn /^[\\n\\r\\t]+$/.test(str);\r\n\t}\r\n\r\n\tstatic isAt(str: string): boolean {\r\n\t\treturn str === '@';\r\n\t}\r\n\r\n\tstatic isDot(str: string): boolean {\r\n\t\treturn str === '.';\r\n\t}\r\n\r\n\tstatic isZero(str: string): boolean {\r\n\t\treturn str === '0';\r\n\t}\r\n\r\n\tstatic isPunctuation(str: string): boolean {\r\n\t\tif (!str) return false;\r\n\t\treturn /^[.,;:!?]+$/.test(str);\r\n\t}\r\n\r\n\tstatic isPunctuationButDot(str: string): boolean {\r\n\t\tif (!str) return false;\r\n\t\treturn /^[,;:!?]+$/.test(str);\r\n\t}\r\n\r\n\tstatic isHashtag(str: string): boolean {\r\n\t\treturn str === '#';\r\n\t}\r\n\r\n\tstatic isSlash(str: string): boolean {\r\n\t\treturn str === '/';\r\n\t}\r\n\r\n\tstatic isParens(str: string): boolean {\r\n\t\tif (!str) return false;\r\n\t\treturn /^[()[\\]{}]+$/.test(str);\r\n\t}\r\n\r\n\tstatic isTag(str: string): boolean {\r\n\t\tif (!str) return false;\r\n\t\treturn /<.+?>/.test(str);\r\n\t}\r\n\r\n\tstatic isCodeOpenTag(str: string): boolean {\r\n\t\tif (!str) return false;\r\n\t\treturn /<code(@@)?\\s?([a-zA-Z-]+=\"[a-zA-Z-_@\\s]+\")?>/.test(str);\r\n\t}\r\n\r\n\tstatic isCodeCloseTag(str: string): boolean {\r\n\t\tif (!str) return false;\r\n\t\treturn /<\\/code>/.test(str);\r\n\t}\r\n\r\n\tstatic isWordInsideAngularBrackets(str: string) {\r\n\t\tif (!str) return false;\r\n\t\treturn /^<+.*>+\\.?$/.test(str);\r\n\t}\r\n\r\n\tstatic isSpecialReadableCharacter(str: string) {\r\n\t\tif (!str) return false;\r\n\t\treturn /^[@#\\\\/_*^°£$%&=+]+$/.test(str);\r\n\t}\r\n\r\n\tstatic isSpecialUnreadableCharacter(str: string) {\r\n\t\tif (!str) return false;\r\n\t\treturn /^[()[\\]{}'\"<>`|-]+$/.test(str);\r\n\t}\r\n\r\n\tstatic isSpecialCharacter(str: string): boolean {\r\n\t\tif (!str) return false;\r\n\t\treturn /^([.,;:\\-_`'\"*+()[\\]{}<>\\s\\n])$/.test(str);\r\n\t}\r\n\r\n\tstatic isHTMLEntity(str: string): boolean {\r\n\t\tif (!str) return false;\r\n\t\treturn /&[a-z]+?;+/.test(str);\r\n\t}\r\n\r\n\tstatic isValidDate(str: string): boolean {\r\n\t\t// @ts-expect-error\r\n\t\treturn new Date(str) > 0;\r\n\t}\r\n\r\n\t/* Type Checks */\r\n\r\n\tstatic isFunction(fn: any) {\r\n\t\treturn fn && typeof fn === 'function';\r\n\t}\r\n\r\n\t/* Utilities */\r\n\r\n\tstatic formatMsToTime(n: number) {\r\n\t\tlet seconds, minutes, hours;\r\n\t\tlet secondsLeft = 0;\r\n\t\tlet minutesLeft = 0;\r\n\t\tseconds = Math.floor(n / 1000);\r\n\t\tsecondsLeft = Math.floor(seconds % 60);\r\n\t\tminutes = Math.floor(seconds / 60);\r\n\t\tminutesLeft = Math.floor(minutes % 60);\r\n\r\n\t\thours = Math.floor(minutes / 60);\r\n\r\n\t\t/* format */\r\n\t\tseconds = secondsLeft.toString().padStart(2, '0');\r\n\t\tminutes = (minutes === minutesLeft ? minutes : minutesLeft)\r\n\t\t\t.toString()\r\n\t\t\t.padStart(2, '0');\r\n\t\thours = hours.toString().padStart(2, 0);\r\n\r\n\t\treturn hours > 0\r\n\t\t\t? `${hours}:${minutes}:${seconds}`\r\n\t\t\t: `${minutes}:${seconds}`;\r\n\t}\r\n\r\n\tstatic debounce(fn: (...arg: any[]) => any, delay: number) {\r\n\t\tlet timeout: Timeout | undefined;\r\n\t\treturn function (...args) {\r\n\t\t\tif (timeout) clearTimeout(timeout);\r\n\t\t\ttimeout = setTimeout(() => fn(...args), delay);\r\n\t\t};\r\n\t}\r\n\r\n\tstatic __join__ = function (\r\n\t\tfn: (el: any, i: number, arr: any[]) => string\r\n\t) {\r\n\t\tlet str = ``;\r\n\t\tlet i = 0;\r\n\r\n\t\tfor (const el of this) {\r\n\t\t\tconst separator = fn(el, i, this);\r\n\t\t\tstr = str + el.toString() + separator;\r\n\t\t\ti++;\r\n\t\t}\r\n\t\treturn str;\r\n\t};\r\n}\r\n","import EventEmitter from 'events';\r\nimport {\r\n\tIStyle,\r\n\tISettings,\r\n\tEvents,\r\n\tIOptions,\r\n\tIState,\r\n\tParams,\r\n\tChunk,\r\n} from './types';\r\nimport { Utils } from './Utils';\r\n\r\nexport class SpeechSynth extends EventEmitter {\r\n\ttextContainer: HTMLElement;\r\n\tsynth: SpeechSynthesis;\r\n\tutterance: SpeechSynthesisUtterance;\r\n\ttimeoutRef: string | number | Timeout | undefined;\r\n\r\n\teditTimeoutRef: string | number | Timeout | undefined;\r\n\r\n\tstyle: IStyle;\r\n\r\n\tevents: Events;\r\n\r\n\tsettings: ISettings;\r\n\toptions: IOptions;\r\n\tstate: IState;\r\n\r\n\t/* \r\n\tThe constructor only required @Param is the TextContainer HTMLElement, \r\n\tthe second @Param is an optional object and all its properties are optional as well \r\n\t*/\r\n\r\n\tconstructor(\r\n\t\ttextContainer: HTMLElement,\r\n\t\t{\r\n\t\t\t/* Generic Settings */\r\n\t\t\tlanguage = 'en',\r\n\t\t\t/* Style */\r\n\t\t\tcolor1 = '#DEE',\r\n\t\t\tcolor2 = '#9DE',\r\n\t\t\t/* Ev handlers */\r\n\t\t\tonEnd = () => null,\r\n\t\t\tonStart = () => null,\r\n\t\t\tonPause = () => null,\r\n\t\t\tonResume = () => null,\r\n\t\t\tonReset = () => null,\r\n\t\t\tonBoundary = () => null,\r\n\t\t\tonTimeTick = () => null,\r\n\t\t\tonWordClick = () => null,\r\n\t\t\tonSeek = () => null,\r\n\t\t\tonSettingsChange = () => null,\r\n\t\t\tonOptionsChange = () => null,\r\n\t\t\tonStyleChange = () => null,\r\n\t\t}: Params = {\r\n\t\t\t/* Generic Settings */\r\n\t\t\tlanguage: 'en',\r\n\t\t\t/* Style */\r\n\t\t\tcolor1: '#DEE',\r\n\t\t\tcolor2: '#9DE',\r\n\t\t\t/* Ev handlers */\r\n\t\t\tonPlay: () => null,\r\n\t\t\tonEnd: () => null,\r\n\t\t\tonStart: () => null,\r\n\t\t\tonPause: () => null,\r\n\t\t\tonResume: () => null,\r\n\t\t\tonReset: () => null,\r\n\t\t\tonBoundary: () => null,\r\n\t\t\tonTimeTick: () => null,\r\n\t\t\tonWordClick: () => null,\r\n\t\t\tonSeek: () => null,\r\n\t\t\tonSettingsChange: () => null,\r\n\t\t\tonOptionsChange: () => null,\r\n\t\t\tonStyleChange: () => null,\r\n\t\t}\r\n\t) {\r\n\t\tsuper();\r\n\r\n\t\tthis.textContainer = textContainer;\r\n\r\n\t\t/* Instances */\r\n\r\n\t\tthis.synth = window.speechSynthesis;\r\n\t\tthis.utterance = new window.SpeechSynthesisUtterance();\r\n\r\n\t\t/* Timeouts */\r\n\r\n\t\tthis.timeoutRef = undefined;\r\n\r\n\t\tthis.editTimeoutRef = undefined;\r\n\r\n\t\t/* Events */\r\n\r\n\t\tthis.events = [\r\n\t\t\t{ type: 'boundary', handlers: [onBoundary] },\r\n\t\t\t{ type: 'time-tick', handlers: [onTimeTick] },\r\n\t\t\t{ type: 'word-click', handlers: [onWordClick] },\r\n\t\t\t{ type: 'start', handlers: [onStart] },\r\n\t\t\t{ type: 'pause', handlers: [onPause] },\r\n\t\t\t{ type: 'resume', handlers: [onResume] },\r\n\t\t\t{ type: 'reset', handlers: [onReset] },\r\n\t\t\t{ type: 'seek', handlers: [onSeek] },\r\n\t\t\t{ type: 'end', handlers: [onEnd] },\r\n\t\t\t{ type: 'settings-change', handlers: [onSettingsChange] },\r\n\t\t\t{ type: 'options-change', handlers: [onOptionsChange] },\r\n\t\t\t{ type: 'style-change', handlers: [onStyleChange] },\r\n\t\t];\r\n\r\n\t\t/* @@@ Proxies @@@ */\r\n\r\n\t\t/* Settings (Utterance settings) */\r\n\r\n\t\tconst settingsSetter = (obj: any, key: string | symbol, value: any) => {\r\n\t\t\tthis.emit('settings-change', this);\r\n\t\t\treturn Reflect.set(obj, key, value);\r\n\t\t};\r\n\r\n\t\tthis.settings = new Proxy(\r\n\t\t\t{\r\n\t\t\t\tpitch: 1,\r\n\t\t\t\tvoiceURI: '',\r\n\t\t\t\tlanguage: language,\r\n\t\t\t\trate: 1,\r\n\t\t\t\tvolume: 0.5,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tset: settingsSetter,\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\t/* Reader Options */\r\n\r\n\t\tconst optionsSetter = (obj: any, key: string | symbol, value: any) => {\r\n\t\t\tthis.emit('options-change', this);\r\n\t\t\treturn Reflect.set(obj, key, value);\r\n\t\t};\r\n\r\n\t\tthis.options = new Proxy(\r\n\t\t\t{\r\n\t\t\t\tisHighlightTextOn: true,\r\n\t\t\t\tisChunksModeOn: Utils.isMobile(),\r\n\t\t\t\tisPreserveHighlighting: true,\r\n\t\t\t\tisUnderlinedOn: true,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tset: optionsSetter,\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\t/* State */\r\n\r\n\t\tconst stateSetter = (obj: any, key: string | symbol, value: any) => {\r\n\t\t\tswitch (key) {\r\n\t\t\t\tcase 'currentWordIndex':\r\n\t\t\t\t\tthis.emit('seek', this);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t//\tconsole.log(key);\r\n\t\t\t}\r\n\t\t\tthis.emit('state-change');\r\n\t\t\treturn Reflect.set(obj, key, value);\r\n\t\t};\r\n\r\n\t\tthis.state = new Proxy(\r\n\t\t\t{\r\n\t\t\t\tisMobile: Utils.isMobile(),\r\n\t\t\t\t/* Internal properties */\r\n\t\t\t\tvoice: {} as SpeechSynthesisVoice,\r\n\t\t\t\tvoices: [] as SpeechSynthesisVoice[],\r\n\t\t\t\t/* UI */\r\n\t\t\t\tisLoading: true,\r\n\t\t\t\t/* Highlight & Reading time */\r\n\t\t\t\ttagIndex: 0,\r\n\t\t\t\tcurrentWord: '',\r\n\t\t\t\tcurrentWordIndex: 0,\r\n\t\t\t\tcurrentWordProps: { charIndex: 0, charLength: 0 },\r\n\t\t\t\thighlightedWords: [] as HTMLElement[],\r\n\t\t\t\tlastWordPosition: 0,\r\n\t\t\t\tnumberOfWords: 0,\r\n\t\t\t\twholeText: '',\r\n\t\t\t\twholeTextArray: [],\r\n\t\t\t\ttextRemaining: '',\r\n\t\t\t\tduration: 0,\r\n\t\t\t\telapsedTime: 0,\r\n\t\t\t\tcurrentChunkIndex: 0,\r\n\t\t\t\tchunksArray: [],\r\n\t\t\t\t/* Controls  */\r\n\t\t\t\tisPaused: false,\r\n\t\t\t\tisReading: false,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tset: stateSetter,\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tconst styleSetter = (obj: any, key: string | symbol, value: any) => {\r\n\t\t\tthis.emit('style-change', this);\r\n\t\t\treturn Reflect.set(obj, key, value);\r\n\t\t};\r\n\r\n\t\tthis.style = new Proxy(\r\n\t\t\t{ color1, color2 },\r\n\t\t\t{\r\n\t\t\t\tset: styleSetter,\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\t/* \r\n\tThis method handles the DOM traversing to add the Highlightint tags to the readable elements and all the logic in it is responsible\r\n\tfor how the text content appears visually\r\n\te.g. alignment of punctuation, spaces, etc...\r\n\t*/\r\n\r\n\tpublic async init(): Promise<SpeechSynth> {\r\n\t\t/* Add custom methods to primitives */\r\n\r\n\t\t// eslint-disable-next-line no-extend-native\r\n\t\tArray.prototype.__join__ = Utils.__join__;\r\n\r\n\t\t/* Get voices */\r\n\r\n\t\ttry {\r\n\t\t\tthis.state.voices = await this.getVoices();\r\n\r\n\t\t\tthis.state.voice = this.state.voices[0];\r\n\r\n\t\t\tthis.settings.voiceURI = this.state.voice.voiceURI;\r\n\r\n\t\t\t/* Add HTML highlight tags if SSR is off, in SSR the tags are added server side invoking the method \".addHTMLHighlightTags\" \r\n    on stringified HTML */\r\n\r\n\t\t\tthis.addHTMLHighlightTags(this.textContainer);\r\n\r\n\t\t\t/* Add basic style to the words that have just been tagged wit HTML tags */\r\n\r\n\t\t\tthis.applyBasicStyleToWords(this.textContainer, '[data-id]');\r\n\r\n\t\t\t/* Init state properties */\r\n\t\t\t/* Get the total number of words to highlight */\r\n\r\n\t\t\tthis.state.numberOfWords = this.retrieveNumberOfWords(\r\n\t\t\t\tthis.textContainer,\r\n\t\t\t\t'[data-id]'\r\n\t\t\t);\r\n\r\n\t\t\t/* Get the whole raw text */\r\n\r\n\t\t\tthis.state.wholeText = this.retrieveWholeText(\r\n\t\t\t\tthis.textContainer,\r\n\t\t\t\t'[data-id]'\r\n\t\t\t);\r\n\r\n\t\t\tthis.state.textRemaining = this.state.wholeText;\r\n\r\n\t\t\t/* Get the total estimated duration of reading */\r\n\r\n\t\t\tthis.state.duration = this.getTextDuration(\r\n\t\t\t\tthis.state.wholeText,\r\n\t\t\t\tthis.settings.rate as number\r\n\t\t\t);\r\n\r\n\t\t\t/* Get the array of words that will be read */\r\n\r\n\t\t\tthis.state.wholeTextArray = this.retrieveWholeTextArray(\r\n\t\t\t\tthis.textContainer,\r\n\t\t\t\t'[data-id]'\r\n\t\t\t) as string[];\r\n\r\n\t\t\tthis.state.chunksArray = this.retrieveChunks();\r\n\r\n\t\t\t/* -------------------------------------------------------------------- */\r\n\r\n\t\t\t/* Attach click event listener to words */\r\n\r\n\t\t\tthis.attachEventListenersToWords(this.textContainer, '[data-id]', {\r\n\t\t\t\ttype: 'click',\r\n\t\t\t\tfn: (e) => {\r\n\t\t\t\t\tthis.emit('word-click', this, e);\r\n\t\t\t\t},\r\n\t\t\t});\r\n\r\n\t\t\t/* Add class custom event listeners */\r\n\r\n\t\t\tthis.addCustomEventListeners();\r\n\r\n\t\t\t/* -------------------------------------------------------------------- */\r\n\r\n\t\t\t/* Init utterance settings */\r\n\r\n\t\t\tthis.initUtterance();\r\n\r\n\t\t\treturn this;\r\n\t\t} catch (e) {\r\n\t\t\tconsole.log('Init error', e);\r\n\t\t\treturn this;\r\n\t\t}\r\n\t}\r\n\r\n\t/* @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ PRIVATE METHODS @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ */\r\n\r\n\tprivate initUtterance() {\r\n\t\tthis.utterance.text = this.options.isChunksModeOn\r\n\t\t\t? this.state.chunksArray[this.state.currentChunkIndex].text\r\n\t\t\t: this.state.wholeText;\r\n\t\tthis.utterance.lang = this.settings.language as string;\r\n\t\tthis.utterance.voice = this.state.voice;\r\n\t\tthis.utterance.pitch = this.settings.pitch as number;\r\n\t\tthis.utterance.rate = this.settings.rate as number;\r\n\t\tthis.utterance.volume = this.settings.volume as number;\r\n\r\n\t\t/* Add the boundary handler to the utterance to manage the highlight ( no mobile supported ) */\r\n\t\tthis.utterance.onboundary = this.handleBoundary.bind(this);\r\n\r\n\t\t/* \r\n\t\tWhen chunks mode is enabled this event is fired multiple times at the end of each chunk.\r\n\t\tUse this to manage chunk highlighting and extra logic that concerns chunks management\r\n\t\t*/\r\n\t\tthis.utterance.onend = (e) => {\r\n\t\t\t/* This prevents the execution of code if the end event is called in response to the reset method being called */\r\n\r\n\t\t\tif (this.state.isReading === false && this.state.isPaused === false)\r\n\t\t\t\treturn;\r\n\r\n\t\t\t/* Emit the \"end\" event which signals the end of the WHOLE text, only when the whole text has finished to be read */\r\n\r\n\t\t\tif (\r\n\t\t\t\t(!this.options.isChunksModeOn &&\r\n\t\t\t\t\tthis.state.currentWordIndex >=\r\n\t\t\t\t\t\tthis.state.wholeTextArray.length - 1) ||\r\n\t\t\t\t(this.options.isChunksModeOn &&\r\n\t\t\t\t\tthis.state.currentChunkIndex >=\r\n\t\t\t\t\t\tthis.state.chunksArray.length - 1)\r\n\t\t\t)\r\n\t\t\t\treturn this.emit('end', this);\r\n\r\n\t\t\t/* Emit the seek event to keep the UI seekbar in sync with the currentWordIndex */\r\n\r\n\t\t\t// this.emit('seek', this);\r\n\r\n\t\t\t/* Handle the highlight options change dynamically */\r\n\t\t\t/* \r\n\t\t\tIf the isPreserveHighlighting option is disabled, \r\n\t\t\tit has to reset the highlighting of the whole previous chunk while skipping to the next one \r\n\t\t\t*/\r\n\t\t\tif (!this.options.isPreserveHighlighting) {\r\n\t\t\t\tthis.resetHighlight();\r\n\t\t\t}\r\n\r\n\t\t\t/* Manage the highlighting of the next chunk just before it starts */\r\n\r\n\t\t\tif (this.options.isChunksModeOn && this.state.isReading)\r\n\t\t\t\tthis.handleChunkHighlighting();\r\n\r\n\t\t\t/* Finally play the next chunk */\r\n\r\n\t\t\tthis.play('next-chunk-start');\r\n\t\t};\r\n\t}\r\n\r\n\tprivate addHTMLHighlightTags(node: Element) {\r\n\t\tconst nodes = [...node.childNodes];\r\n\t\tnodes.forEach((el) => {\r\n\t\t\t/* Exclude code tags and its content from parsing */\r\n\t\t\tif (\r\n\t\t\t\tel.nodeType === 1 &&\r\n\t\t\t\t((el as HTMLElement).tagName === 'PRE' ||\r\n\t\t\t\t\t(el as HTMLElement).tagName === 'CODE')\r\n\t\t\t)\r\n\t\t\t\treturn;\r\n\r\n\t\t\t/* Recurse if the element is an HTMLElement */\r\n\r\n\t\t\tif (el.nodeType === 1) this.addHTMLHighlightTags(el as Element);\r\n\r\n\t\t\t/* Begin text node parsing if node type is TextNode */\r\n\r\n\t\t\tif (el.nodeType === 3) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tUtils.isEmptyString(el.textContent as string) ||\r\n\t\t\t\t\tUtils.isSpace(el.textContent as string) ||\r\n\t\t\t\t\tUtils.isWhitespaceChar(el.textContent as string)\r\n\t\t\t\t)\r\n\t\t\t\t\treturn;\r\n\t\t\t\tconst wrapper = document.createElement('span');\r\n\r\n\t\t\t\t(el as Text).data\r\n\t\t\t\t\t.split('')\r\n\t\t\t\t\t.filter((char, i, arr) => {\r\n\t\t\t\t\t\t/* Dismiss empty strings or non valid values */\r\n\r\n\t\t\t\t\t\tif (!char) return false;\r\n\r\n\t\t\t\t\t\t/* Get rid of spaces between words and punctuation */\r\n\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tUtils.isSpace(char) &&\r\n\t\t\t\t\t\t\tUtils.isPunctuation(arr[i + 1])\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t\t\t/* Get rid of multiple spaces to avoid inconsistencies */\r\n\r\n\t\t\t\t\t\tif (Utils.isSpace(char) && Utils.isSpace(arr[i + 1]))\r\n\t\t\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\t/* Separate special characters that will be read as single characters */\r\n\r\n\t\t\t\t\t.map((c, i, arr) => {\r\n\t\t\t\t\t\t/* Replace whitespace characters with common spaces */\r\n\r\n\t\t\t\t\t\tif (Utils.isWhitespaceChar(c)) return ' ';\r\n\r\n\t\t\t\t\t\t/* Separate the special readable characters like @#^*° so they can be read accordingly */\r\n\r\n\t\t\t\t\t\tif (Utils.isSpecialReadableCharacter(c))\r\n\t\t\t\t\t\t\treturn ` ${c} `;\r\n\r\n\t\t\t\t\t\t/* Handle dots in the middle of numbers e.g. 1.000 1.23 */\r\n\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tUtils.isDot(c) &&\r\n\t\t\t\t\t\t\tUtils.isNumber(arr[i - 1]) &&\r\n\t\t\t\t\t\t\tUtils.isNumber(arr[i + 1])\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\treturn `${c}`;\r\n\r\n\t\t\t\t\t\t/* Handle dots in the middle of words and numbers e.g. some.text e.g. abc33.bb32 , \r\n\t\t\t\t\t\tsince in this case they are read as a character : \"some dot text\" \"one dot zero zero zero\" */\r\n\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tUtils.isDot(c) &&\r\n\t\t\t\t\t\t\tUtils.isWordWithNumbers(arr[i - 1]) &&\r\n\t\t\t\t\t\t\tUtils.isWordWithNumbers(arr[i + 1])\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\treturn ` ${c} `;\r\n\r\n\t\t\t\t\t\t/* Handle the punctation characters apart dots placed in the middle of a word e.g. test:test --> test: test */\r\n\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tUtils.isPunctuationButDot(c) &&\r\n\t\t\t\t\t\t\tUtils.isWord(arr[i - 1]) &&\r\n\t\t\t\t\t\t\tUtils.isWord(arr[i + 1])\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\treturn `${c} `;\r\n\r\n\t\t\t\t\t\t/* Handle multiple zeroes in a row, since they are read a single separated words */\r\n\r\n\t\t\t\t\t\treturn c;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.join('')\r\n\t\t\t\t\t.split(' ')\r\n\t\t\t\t\t.forEach((word, i, arr) => {\r\n\t\t\t\t\t\tif (!word) return;\r\n\r\n\t\t\t\t\t\t/* If it's a special unreadable character or a dot it does not add an highlight data-id since those characters won't  be read */\r\n\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t// Utils.isPunctuation(word) ||\r\n\t\t\t\t\t\t\tUtils.isSpecialUnreadableCharacter(word) ||\r\n\t\t\t\t\t\t\tUtils.isWordInsideAngularBrackets(word)\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tconst newEl = document.createTextNode(word + ' ');\r\n\t\t\t\t\t\t\twrapper.appendChild(newEl);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t/* In all other cases, which is, \"plain words or slashes or any other readable character\" we add the data-id attribute */\r\n\r\n\t\t\t\t\t\t\tconst newEl = document.createElement('span');\r\n\r\n\t\t\t\t\t\t\tnewEl.setAttribute(\r\n\t\t\t\t\t\t\t\t'data-id',\r\n\t\t\t\t\t\t\t\t(this.state.tagIndex++).toString()\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tnewEl.setAttribute('data-type', 'WORD');\r\n\r\n\t\t\t\t\t\t\t/* Do not add a space after the word if it's a special readable character or if the next word is not a plain word */\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tUtils.isSpecialReadableCharacter(word) ||\r\n\t\t\t\t\t\t\t\tUtils.isSpecialReadableCharacter(arr[i + 1]) ||\r\n\t\t\t\t\t\t\t\tUtils.isDot(word) ||\r\n\t\t\t\t\t\t\t\tUtils.isDot(arr[i + 1]) ||\r\n\t\t\t\t\t\t\t\tUtils.isZero(word)\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tnewEl.textContent = word;\r\n\t\t\t\t\t\t\t} else newEl.textContent = word + ' ';\r\n\t\t\t\t\t\t\t/* Add a space after the words that are Text words */\r\n\r\n\t\t\t\t\t\t\twrapper.appendChild(newEl);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\tnode.replaceChild(wrapper, el);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/*  Highlight  */\r\n\r\n\tprivate highlightChunk(idx: number) {\r\n\t\tconst length =\r\n\t\t\tthis.state.currentWordIndex + this.state.chunksArray[idx].length;\r\n\t\tfor (let i = this.state.currentWordIndex; i < length; i++)\r\n\t\t\tthis.highlightText(i);\r\n\t}\r\n\r\n\tprivate retrieveChunks(): Chunk[] {\r\n\t\tlet currentPunctuationSymbol = '.';\r\n\t\tconst chunks: Chunk[] = [];\r\n\t\tlet previousEnd = 0;\r\n\r\n\t\t/* \r\n\t\tTake into account that all the special readable characters will be counted as plain words hence we need to:\r\n\t\t- use the \"wholeTextArray\" which holds all the text elements that were wrapped in a span tag with a data-id attribute,\r\n\t\t  this ensures that it will contain all readable content, since only readable words/characters are given such a wrap tag in \r\n\t\t  \"addHTMLHighlightTags\" method.\r\n\t\t  This further ensures to have a unique source of truth to keep in sync reading content and visual highlighting.\r\n\t\t- join with spaces every single character wrapped with a data-id attribute tag to be able to further split on given breakpoints\r\n\t\t- split in segments relative to periods that have words ending with a punctuation mark, to do so we use this regexp \"/(?<=[a-zA-Z0-9])[.?!;]/\"\r\n\t\t  to make sure to select any punctuation mark that is preceeded by a word\r\n\t\t  ( to avoid to consider punctuation in the middle of words as chunk edges, we use the wholeTextArray array\r\n\t\t\twhich already owns all characters that will be read, included dots in the middle of words e.g. text.text -> \"text dot text\" ).\r\n\t\t- for each of the chunk extracted we build an object containg all the info on the chunk, start,end,length, index and text.\r\n\t\t  The text is the content that will be passed to the speech synth \r\n\t\t- The chunk text has to be further manipulated since now as we manipulated the chunk the dots in the middle of the word won't be read as they are detached from the previous and next words.\r\n\t\t  The strategy here is the same used in the \"retrieveWholeText\" method, which is: using the custom __join__ method\r\n\t\t  tho use a space \" \" to join all the plain words and a no space \"\" to join the words that have a punctuation element next to them and dots element themselves */\r\n\r\n\t\tthis.state.wholeTextArray\r\n\t\t\t.join(' ')\r\n\t\t\t/* Alternative regexps:\r\n\t\t\t1- /(?<![\\s])[.?!;]+(?=[\\s\\n])/ This is safer since it just checks if there are spaces before and after the dot \r\n\t\t\t2- /(?<=[a-zA-Z0-9])[.?!;]/  This does not take into account dots placed after a special character like a parens e.g. (word). <-- That dot won't be matched\r\n\t\t\t*/\r\n\t\t\t.split(/(?<![\\s])[.?!;]+(?=[\\s\\n])/)\r\n\t\t\t.forEach((c, i) => {\r\n\t\t\t\tif (Utils.isPunctuation(c)) currentPunctuationSymbol = c;\r\n\t\t\t\telse {\r\n\t\t\t\t\tconst length = c\r\n\t\t\t\t\t\t.trim()\r\n\t\t\t\t\t\t.split(/[\\s]/)\r\n\t\t\t\t\t\t.filter((el) => el).length;\r\n\t\t\t\t\t/*  */\r\n\r\n\t\t\t\t\tconst text = c.split(/\\s+/).__join__((el, i, arr) => {\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tUtils.isPunctuation(arr[i + 1] as string) ||\r\n\t\t\t\t\t\t\tUtils.isDot(el)\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\treturn '';\r\n\t\t\t\t\t\t} else return ' ';\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tconst result: Chunk = {\r\n\t\t\t\t\t\ttext: text + currentPunctuationSymbol,\r\n\t\t\t\t\t\tlength: length,\r\n\t\t\t\t\t\tstart: previousEnd,\r\n\t\t\t\t\t\tend: previousEnd + length - 1,\r\n\t\t\t\t\t\tidx: i,\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tpreviousEnd = previousEnd + length;\r\n\t\t\t\t\tchunks.push(result);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\treturn chunks;\r\n\t}\r\n\r\n\tprivate handleChunkHighlighting() {\r\n\t\t// eslint-disable-next-line prettier/prettier\r\n\t\tconst currentChunk =\r\n\t\t\tthis.state.chunksArray[this.state.currentChunkIndex];\r\n\t\t// eslint-disable-next-line prettier/prettier\r\n\t\tconst nextChunk =\r\n\t\t\tthis.state.chunksArray[++this.state.currentChunkIndex];\r\n\r\n\t\tthis.utterance.text = nextChunk.text;\r\n\r\n\t\t/* Keep the currentWordIndex in sync */\r\n\t\tthis.state.currentWordIndex += currentChunk.length;\r\n\r\n\t\t/* Highlight the next chunk */\r\n\r\n\t\tthis.highlightChunk(this.state.currentChunkIndex);\r\n\t}\r\n\r\n\tprivate scrollTo(idx: number): void {\r\n\t\tconst el: HTMLElement | null = this.textContainer.querySelector(\r\n\t\t\t`[data-id=\"${idx}\"]`\r\n\t\t);\r\n\t\tif (el)\r\n\t\t\tel.scrollIntoView({\r\n\t\t\t\tbehavior: 'smooth',\r\n\t\t\t\tblock: 'center',\r\n\t\t\t});\r\n\t}\r\n\r\n\t/* Timer */\r\n\r\n\tprivate timeCount(e: SpeechSynthesisEvent | null, frequency: number) {\r\n\t\tif (frequency % 10 !== 0)\r\n\t\t\tthrow new Error('Frequency must be a multiple of 10');\r\n\t\tthis.state.elapsedTime += frequency;\r\n\r\n\t\tif (this.state.elapsedTime % 1000 === 0) {\r\n\t\t\t/* Instructions executed every 1000ms when the reader is active */\r\n\t\t\tthis.emit('time-tick', this, this.state.elapsedTime);\r\n\t\t}\r\n\r\n\t\tthis.timeoutRef = setTimeout(\r\n\t\t\tthis.timeCount.bind(this, e, frequency),\r\n\t\t\tfrequency\r\n\t\t);\r\n\t}\r\n\r\n\tprivate clearTimeCount() {\r\n\t\tclearTimeout(this.timeoutRef);\r\n\t}\r\n\r\n\tprivate resetTimeCount() {\r\n\t\tthis.state.elapsedTime = 0;\r\n\t\tthis.clearTimeCount();\r\n\t}\r\n\r\n\t/* Handle the boundary event */\r\n\r\n\tprivate handleBoundary(e: SpeechSynthesisEvent) {\r\n\t\t/* Disable boundary if it's in chunk mode */\r\n\t\tif (this.options.isChunksModeOn) return;\r\n\r\n\t\tthis.state.currentWord =\r\n\t\t\tthis.state.wholeTextArray[this.state.currentWordIndex];\r\n\r\n\t\tconst previousWord =\r\n\t\t\tthis.state.wholeTextArray[this.state.currentWordIndex - 1];\r\n\r\n\t\t/* This is very important since it ensures the sync among words that are read \r\n\t\tand those that are highlighted is not messed up  */\r\n\r\n\t\tif (e.name !== 'word' || e.charLength === 0) return;\r\n\r\n\t\t/* \r\n\t\tDisable boundary if the word is the repetition of the previous one, this happens in certain cases like numbers\r\n\t\te.g. 1000 is spelled \"one thousand\" even if it's just one word, hence the boundary is fired twice and dates.\r\n\t\tThis increase consistency in visual highlighting and audio sync.\r\n\t\t*/\r\n\r\n\t\tif (\r\n\t\t\t(Utils.isNumber(previousWord) || Utils.isValidDate(previousWord)) &&\r\n\t\t\te.charIndex === this.state.currentWordProps.charIndex &&\r\n\t\t\te.charLength === this.state.currentWordProps.charLength\r\n\t\t)\r\n\t\t\treturn;\r\n\r\n\t\t/* Sync current word props */\r\n\t\tthis.state.currentWordProps = {\r\n\t\t\tcharIndex: e.charIndex,\r\n\t\t\tcharLength: e.charLength,\r\n\t\t};\r\n\r\n\t\t/* Highlight the current word */\r\n\t\tthis.highlightText(this.state.currentWordIndex);\r\n\r\n\t\t/* Increase the current index of word read */\r\n\r\n\t\tthis.state.currentWordIndex += 1;\r\n\r\n\t\t/* Synchronize the chunk index */\r\n\r\n\t\tif (\r\n\t\t\t/[.?!;]+/.test(\r\n\t\t\t\tthis.state.wholeTextArray[this.state.currentWordIndex]\r\n\t\t\t)\r\n\t\t)\r\n\t\t\tthis.state.currentChunkIndex++;\r\n\r\n\t\t/* Emit boundary event */\r\n\r\n\t\tthis.emit('boundary', this, e);\r\n\t}\r\n\r\n\t/* VOICES ARE POPULATED ASYNCHRONOUSLY ON BROWSER LOAD */\r\n\r\n\tprivate getVoices(): Promise<SpeechSynthesisVoice[]> {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tlet id: Interval | null = null;\r\n\t\t\ttry {\r\n\t\t\t\tid = setInterval(() => {\r\n\t\t\t\t\tif (this.synth.getVoices().length !== 0) {\r\n\t\t\t\t\t\tresolve(\r\n\t\t\t\t\t\t\tthis.synth\r\n\t\t\t\t\t\t\t\t.getVoices()\r\n\t\t\t\t\t\t\t\t.filter((voice) =>\r\n\t\t\t\t\t\t\t\t\tvoice.lang.startsWith(\r\n\t\t\t\t\t\t\t\t\t\tthis.settings.language as string\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tclearInterval(id as Interval);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 10);\r\n\t\t\t} catch (e) {\r\n\t\t\t\treject(e);\r\n\t\t\t\tclearInterval(id as Interval);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate highlightText(wordIndex: number): void {\r\n\t\t/* Do not highlight if the option is disabled */\r\n\t\tif (!this.options.isHighlightTextOn) return;\r\n\r\n\t\t// eslint-disable-next-line prettier/prettier\r\n\t\tconst wordToHighlight: HTMLElement | null =\r\n\t\t\tthis.textContainer.querySelector(`[data-id=\"${wordIndex}\"]`);\r\n\r\n\t\tif (!wordToHighlight) return;\r\n\r\n\t\t/* Update highlighted words array */\r\n\r\n\t\tthis.state.highlightedWords.push(wordToHighlight);\r\n\r\n\t\t/* Calculate current word position */\r\n\r\n\t\tconst position = wordToHighlight.getBoundingClientRect().x;\r\n\r\n\t\t/* Scroll to the right row position */\r\n\r\n\t\tif (position <= this.state.lastWordPosition)\r\n\t\t\tthis.scrollTo(this.state.currentWordIndex);\r\n\r\n\t\t/* Reset the row highlight only if it's not in chunks mode.\r\n\t\t   In chunks mode, it has to be managed during the chunks switch ( in the \"onend\" handler) */\r\n\r\n\t\tif (\r\n\t\t\t!this.options.isPreserveHighlighting &&\r\n\t\t\t!this.options.isChunksModeOn\r\n\t\t) {\r\n\t\t\tthis.resetHighlight();\r\n\t\t\tthis.state.highlightedWords = [wordToHighlight];\r\n\t\t}\r\n\r\n\t\t/* Update last word position */\r\n\r\n\t\tthis.state.lastWordPosition = position;\r\n\r\n\t\t/* Apply highlight style */\r\n\r\n\t\tthis.applyStyleToWord(wordToHighlight);\r\n\t}\r\n\r\n\tprivate applyStyleToWord(el: HTMLElement) {\r\n\t\tel.style.backgroundColor = this.style.color1 as string;\r\n\t\tel.style.boxShadow = `10px 0px 0px 0px ${this.style.color1} -10px 0px 0px 0px ${this.style.color1}`;\r\n\t\tel.style.textDecoration = this.options.isUnderlinedOn\r\n\t\t\t? 'underline'\r\n\t\t\t: 'none';\r\n\t}\r\n\r\n\tprivate changeChunkMode() {\r\n\t\tthis.clearTimeCount();\r\n\r\n\t\t/* Since che chunk mode change triggers a restart of the utterance playing,\r\n\t\tmake sure the current word index gets synchronized with the current chunk index start word,\r\n\t\tsince the sentence is restarted from the first word of the sentence itself */\r\n\r\n\t\t// eslint-disable-next-line prettier/prettier\r\n\t\tthis.state.currentWordIndex =\r\n\t\t\tthis.state.chunksArray[this.state.currentChunkIndex].start;\r\n\r\n\t\t/* This manages the starting highlight if chunk mode is on or off:\r\n\t\t\t1. if it starts in single word mode and it gets changed to chunk mode, it highlights the whole chunk\r\n\t\t\t2. if it starts in chunk mode and it gets changed to single word mode, it resets all the current highlighthing and starts to highlight words singularly */\r\n\r\n\t\tif (this.options.isChunksModeOn)\r\n\t\t\tthis.highlightChunk(this.state.currentChunkIndex);\r\n\t\telse this.resetHighlight();\r\n\r\n\t\tthis.utterance.text = this.options.isChunksModeOn\r\n\t\t\t? this.getCurrentChunkText(this.state.currentChunkIndex)\r\n\t\t\t: this.getRemainingText(this.state.currentWordIndex);\r\n\r\n\t\tthis.restart('chunks-mode-change');\r\n\t}\r\n\r\n\tprivate resetHighlight() {\r\n\t\tthis.state.highlightedWords.forEach((n) => {\r\n\t\t\t(n as HTMLElement).style.backgroundColor = '';\r\n\t\t\t(n as HTMLElement).style.boxShadow = '';\r\n\t\t\t(n as HTMLElement).style.textDecoration = 'none';\r\n\r\n\t\t\tthis.state.highlightedWords = [];\r\n\t\t});\r\n\t}\r\n\r\n\tprivate addCustomEventListeners() {\r\n\t\tthis.events.forEach((e) => {\r\n\t\t\tif (e.handlers.length > 0) {\r\n\t\t\t\tfor (const handler of e.handlers) {\r\n\t\t\t\t\tif (Utils.isFunction(handler))\r\n\t\t\t\t\t\tthis.on(e.type, handler.bind(this));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate attachEventListenersToWords(\r\n\t\tnode: Element,\r\n\t\tselector: string,\r\n\t\t{ type, fn }: { type: string; fn: (e: Event) => any }\r\n\t) {\r\n\t\t[...node.querySelectorAll(selector)].forEach((el) => {\r\n\t\t\tel.addEventListener(type, fn);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate getRemainingText(idx: number): string {\r\n\t\tconst length = this.state.wholeTextArray.length;\r\n\t\t/* Calculate and set the remaining text */\r\n\t\treturn this.state.wholeTextArray\r\n\t\t\t.slice(idx, length + 1)\r\n\t\t\t.__join__((el, i, arr) => {\r\n\t\t\t\tif (Utils.isDot(arr[i + 1] as string) || Utils.isDot(el)) {\r\n\t\t\t\t\treturn '';\r\n\t\t\t\t} else return ' ';\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate getCurrentChunkText(idx: number) {\r\n\t\treturn this.state.chunksArray[idx].text;\r\n\t}\r\n\r\n\tprivate retrieveNumberOfWords(node: Element, selector: string) {\r\n\t\treturn [...node.querySelectorAll(selector)].length;\r\n\t}\r\n\r\n\tprivate retrieveWholeText(node: Element, selector: string) {\r\n\t\treturn [...node.querySelectorAll(selector)]\r\n\t\t\t.map((el) => el.textContent)\r\n\t\t\t.__join__((el, i, arr) => {\r\n\t\t\t\tif (\r\n\t\t\t\t\tUtils.isPunctuation(arr[i + 1] as string) ||\r\n\t\t\t\t\tUtils.isDot(el)\r\n\t\t\t\t) {\r\n\t\t\t\t\treturn '';\r\n\t\t\t\t} else return ' ';\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate retrieveWholeTextArray(node: Element, selector: string) {\r\n\t\treturn [...node.querySelectorAll(selector)].map((el) => el.textContent);\r\n\t}\r\n\r\n\tprivate applyBasicStyleToWords(node: Element, selector: string) {\r\n\t\t[...node.querySelectorAll(selector)]\r\n\t\t\t.filter(\r\n\t\t\t\t(el) => el && !Utils.isPunctuation(el.textContent as string)\r\n\t\t\t)\r\n\t\t\t.forEach((el) => {\r\n\t\t\t\tif (!el) return;\r\n\t\t\t\t(el as HTMLElement).style.transition = 'all 0.4s';\r\n\t\t\t});\r\n\t}\r\n\r\n\tprivate getTextDuration(str: string, rate: number) {\r\n\t\treturn (str.length * 100 * 1) / rate;\r\n\t}\r\n\r\n\tprivate getAverageTextElapsedTime(textArray: string[], idx: number) {\r\n\t\tconst _text = textArray.slice(0, idx).join(' ');\r\n\t\treturn (rate: number) => this.getTextDuration(_text, rate);\r\n\t}\r\n\r\n\tprivate delayRestart(type: string, delay: number) {\r\n\t\treturn setTimeout(() => {\r\n\t\t\tthis.synth.cancel();\r\n\t\t\tif (this.isReading()) this.play(type);\r\n\t\t\tif (this.isPaused()) {\r\n\t\t\t\tthis.play(type).then(() => this.pause());\r\n\t\t\t\tthis.pause();\r\n\t\t\t}\r\n\t\t}, 500);\r\n\t}\r\n\r\n\tprivate restart(type: string) {\r\n\t\tthis.synth.cancel();\r\n\t\tif (this.isReading()) this.play(type);\r\n\t\tif (this.isPaused()) {\r\n\t\t\tthis.play(type).then(() => this.pause());\r\n\t\t\tthis.pause();\r\n\t\t}\r\n\t}\r\n\r\n\t/* @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ PUBLIC METHODS - EXPOSED API @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ */\r\n\r\n\tchangeSettings(obj: Partial<ISettings>) {\r\n\t\t/* Reset timeouts  */\r\n\r\n\t\tthis.clearTimeCount();\r\n\r\n\t\t/* Update voice in the state if it changes */\r\n\r\n\t\tif (obj.voiceURI) {\r\n\t\t\tconst voice =\r\n\t\t\t\tthis.state.voices.filter((v) => v.voiceURI === obj.voiceURI)\r\n\t\t\t\t\t.length > 0\r\n\t\t\t\t\t? this.state.voices.filter(\r\n\t\t\t\t\t\t\t(v) => v.voiceURI === obj.voiceURI\r\n\t\t\t\t\t  )[0]\r\n\t\t\t\t\t: this.state.voices[0];\r\n\t\t\tthis.state.voice = voice;\r\n\t\t\tthis.utterance.voice = voice as SpeechSynthesisVoice;\r\n\t\t}\r\n\r\n\t\t/* Recalculate total duration  and current elapsedTime when rate changes */\r\n\r\n\t\tif (obj.rate) {\r\n\t\t\tthis.state.duration = this.getTextDuration(\r\n\t\t\t\tthis.state.wholeText,\r\n\t\t\t\tobj.rate\r\n\t\t\t);\r\n\r\n\t\t\t/* Recalculate time elapsed */\r\n\r\n\t\t\tthis.state.elapsedTime = this.getAverageTextElapsedTime(\r\n\t\t\t\tthis.state.wholeTextArray,\r\n\t\t\t\tthis.state.currentWordIndex\r\n\t\t\t)(this.settings.rate as number);\r\n\r\n\t\t\tthis.emit('time-tick', this, this.state.elapsedTime);\r\n\t\t}\r\n\r\n\t\t/* Update utterance object, adding the remaining settings and remaining text left to be played */\r\n\r\n\t\tthis.utterance = Object.assign(this.utterance, {\r\n\t\t\t...obj,\r\n\t\t\ttext: this.options.isChunksModeOn\r\n\t\t\t\t? this.getCurrentChunkText(this.state.currentChunkIndex)\r\n\t\t\t\t: this.getRemainingText(this.state.currentWordIndex),\r\n\t\t});\r\n\r\n\t\t/* Update instance settings object to keep them in sync with utterance settings and trigger the Proxy trap to emit the \"change-settings\" event */\r\n\t\tfor (const entry of Object.entries(obj))\r\n\t\t\tthis.settings[entry[0]] = entry[1];\r\n\r\n\t\t/*  Debounce to handle volume change properly */\r\n\r\n\t\tthis.restart('edit-utterance');\r\n\t}\r\n\r\n\tchangeOptions(obj: Partial<IOptions>) {\r\n\t\tfor (const entry of Object.entries(obj))\r\n\t\t\tthis.options[entry[0]] = entry[1];\r\n\r\n\t\t/* Handle chunks mode option change */\r\n\t\tif ('isChunksModeOn' in obj) {\r\n\t\t\tthis.changeChunkMode();\r\n\t\t}\r\n\t\t/* Handle underline option change */\r\n\t\tif ('isUnderlinedOn' in obj) {\r\n\t\t\tthis.changeStyle({\r\n\t\t\t\ttype: 'underline-mode',\r\n\t\t\t\tvalue: obj.isUnderlinedOn,\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tchangeStyle({ type, value }) {\r\n\t\tswitch (type) {\r\n\t\t\tcase 'highlight-color':\r\n\t\t\t\tthis.style.color1 = value;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'underlined-mode':\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t}\r\n\t\t/* Apply the new style to the previously highlighted words */\r\n\t\tthis.state.highlightedWords.forEach((w) => this.applyStyleToWord(w));\r\n\t}\r\n\r\n\t/* Control methods */\r\n\r\n\tseekTo(idx: number) {\r\n\t\t/* Reset timeouts  */\r\n\r\n\t\tthis.clearTimeCount();\r\n\r\n\t\t/* Sync the current chunk in both cases that the seeking is performed in chunk or non chunk mode */\r\n\r\n\t\tconst chunk = this.state.chunksArray.find(\r\n\t\t\t(c) => idx >= c.start && idx <= c.end\r\n\t\t) as Chunk;\r\n\r\n\t\tthis.state.currentChunkIndex = chunk.idx as number;\r\n\r\n\t\tif (!this.options.isChunksModeOn) {\r\n\t\t\t/* Set the new text slice */\r\n\r\n\t\t\tthis.state.textRemaining = this.getRemainingText(idx);\r\n\r\n\t\t\t/* Update current word index */\r\n\r\n\t\t\tthis.state.currentWordIndex = idx;\r\n\r\n\t\t\t/* Update utterance instance with  the new text slice */\r\n\r\n\t\t\tthis.utterance.text = this.state.textRemaining;\r\n\r\n\t\t\t/* Highlight */\r\n\r\n\t\t\tthis.resetHighlight();\r\n\t\t\tthis.highlightText(this.state.currentWordIndex);\r\n\t\t} else {\r\n\t\t\t/* In Chunks mode sync the current word index with the start of the chunk */\r\n\t\t\tthis.state.currentWordIndex = chunk.start;\r\n\t\t\tthis.utterance.text = chunk.text;\r\n\r\n\t\t\t/* Highlight */\r\n\r\n\t\t\tthis.resetHighlight();\r\n\t\t\tthis.highlightChunk(this.state.currentChunkIndex);\r\n\t\t}\r\n\r\n\t\t/* Recalculate time elapsed */\r\n\r\n\t\tthis.state.elapsedTime = this.getAverageTextElapsedTime(\r\n\t\t\tthis.state.wholeTextArray,\r\n\t\t\tthis.state.currentWordIndex\r\n\t\t)(this.settings.rate as number);\r\n\r\n\t\tthis.emit('time-tick', this, this.state.elapsedTime);\r\n\t\tthis.restart('seek');\r\n\t}\r\n\r\n\t/* ------------------------------------------------------------------------------------ */\r\n\t/* Public Methods to control the player state */\r\n\t/* ------------------------------------------------------------------------------------ */\r\n\r\n\tplay(type?: string): Promise<null> {\r\n\t\tthis.synth.cancel(); // Makes sure the queue is empty when starting\r\n\t\tthis.clearTimeCount(); // Makes sure to not trigger multiple timeouts\r\n\r\n\t\tthis.synth.speak(this.utterance);\r\n\r\n\t\tthis.state.isPaused = false;\r\n\t\tthis.state.isReading = true;\r\n\r\n\t\tthis.timeCount(null, 20);\r\n\r\n\t\tswitch (type) {\r\n\t\t\tcase 'start': {\r\n\t\t\t\tthis.emit('start', this);\r\n\t\t\t\treturn new Promise((resolve) => {\r\n\t\t\t\t\tthis.utterance.onstart = (e) => {\r\n\t\t\t\t\t\t/* Highlight the first chunk on the first start if it's chunks mode ON / mobile */\r\n\t\t\t\t\t\tif (this.options.isChunksModeOn) this.highlightChunk(0);\r\n\t\t\t\t\t\tresolve(null);\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tcase 'resume-chunk-mode': {\r\n\t\t\t\tthis.emit('resume-chunk-mode', this);\r\n\t\t\t\treturn new Promise((resolve) => {\r\n\t\t\t\t\tthis.utterance.onstart = (e) => {\r\n\t\t\t\t\t\tresolve(null);\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tcase 'next-chunk-start': {\r\n\t\t\t\tthis.emit(\r\n\t\t\t\t\t'next-chunk-start',\r\n\t\t\t\t\tthis,\r\n\t\t\t\t\tthis.state.chunksArray[this.state.currentChunkIndex]\r\n\t\t\t\t);\r\n\t\t\t\treturn new Promise((resolve) => {\r\n\t\t\t\t\tthis.utterance.onstart = (e) => {\r\n\t\t\t\t\t\tresolve(null);\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tcase 'edit-utterance-settings': {\r\n\t\t\t\treturn new Promise((resolve) => {\r\n\t\t\t\t\tthis.utterance.onstart = (e) => {\r\n\t\t\t\t\t\tresolve(null);\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tcase 'chunks-mode-change': {\r\n\t\t\t\treturn new Promise((resolve) => {\r\n\t\t\t\t\tthis.utterance.onstart = (e) => {\r\n\t\t\t\t\t\tresolve(null);\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tdefault:\r\n\t\t\t\treturn new Promise((resolve) => {\r\n\t\t\t\t\tthis.utterance.onstart = (e) => {\r\n\t\t\t\t\t\tresolve(null);\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tpause() {\r\n\t\tthis.synth.pause();\r\n\t\tthis.state.isPaused = true;\r\n\t\tthis.state.isReading = false;\r\n\t\tthis.emit('pause', this);\r\n\r\n\t\t/* Pause timer */\r\n\t\tthis.clearTimeCount();\r\n\t}\r\n\r\n\tresume() {\r\n\t\tif (!this.options.isChunksModeOn) this.synth.resume();\r\n\t\telse this.play('resume-chunk-mode');\r\n\t\tthis.state.isPaused = false;\r\n\t\tthis.state.isReading = true;\r\n\t\tthis.emit('resume', this);\r\n\r\n\t\t/* Restart timer */\r\n\r\n\t\tthis.timeCount(null, 20);\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.synth.cancel();\r\n\t\tthis.resetHighlight();\r\n\r\n\t\t/* Reset timer */\r\n\r\n\t\tthis.resetTimeCount();\r\n\r\n\t\tconst propsToReset = {\r\n\t\t\ttextRemaining: this.state.wholeText,\r\n\t\t\tcurrentWordIndex: 0,\r\n\t\t\tcurrentChunkIndex: 0,\r\n\t\t\thighlightedWords: [],\r\n\t\t\tlastWordPosition: 0,\r\n\t\t\tisPaused: false,\r\n\t\t\tisReading: false,\r\n\t\t};\r\n\t\tfor (const entry of Object.entries(propsToReset))\r\n\t\t\tthis.state[entry[0]] = entry[1];\r\n\r\n\t\t/* Reset the utterance state ( needed to reset the text utterance ) */\r\n\r\n\t\tthis.initUtterance();\r\n\r\n\t\t/* Scroll back to top word */\r\n\r\n\t\tthis.scrollTo(1);\r\n\r\n\t\tthis.emit('reset', this);\r\n\t}\r\n\r\n\t/* Utility getters */\r\n\r\n\tisReading() {\r\n\t\treturn this.state.isReading;\r\n\t}\r\n\r\n\tisPaused() {\r\n\t\treturn this.state.isPaused;\r\n\t}\r\n}\r\n","import { IGlobalState } from './types';\r\n\r\nexport const globalState: IGlobalState = {\r\n\tsettings: {\r\n\t\trate: 1,\r\n\t\tvoiceURI: '',\r\n\t\tvolume: 0.5,\r\n\t\tpitch: 0,\r\n\t\tlanguage: 'en',\r\n\t},\r\n\toptions: {\r\n\t\tisPreserveHighlighting: true,\r\n\t\tisHighlightTextOn: true,\r\n\t\tisChunksModeOn: false,\r\n\t\tisUnderlinedOn: true,\r\n\t},\r\n\thighlightStyle: {\r\n\t\tcolor1: '',\r\n\t\tcolor2: '',\r\n\t},\r\n\tisReading: false,\r\n\tisLoading: false,\r\n\tvoices: [],\r\n\telapsedTime: 0,\r\n\tisMinimized: true,\r\n\tisVisible: true,\r\n\tisOptionsVisible: false,\r\n\tnumberOfWords: 0,\r\n\tcurrentWordIndex: 1,\r\n\tduration: 0,\r\n};\r\n\r\nexport const rootReducer = (state: IGlobalState, action: ActionType) => {\r\n\tconst { type, payload } = action;\r\n\tswitch (type) {\r\n\t\tcase 'SET_IS_READING': {\r\n\t\t\treturn { ...state, isReading: payload };\r\n\t\t}\r\n\t\tcase 'SET_IS_LOADING': {\r\n\t\t\treturn { ...state, isLoading: payload };\r\n\t\t}\r\n\t\tcase 'SET_IS_MINIMIZED': {\r\n\t\t\treturn { ...state, isMinimized: payload };\r\n\t\t}\r\n\t\tcase 'SET_IS_VISIBLE': {\r\n\t\t\treturn { ...state, isVisible: payload };\r\n\t\t}\r\n\t\tcase 'SET_IS_OPTIONS_VISIBLE': {\r\n\t\t\treturn { ...state, isOptionsVisible: payload };\r\n\t\t}\r\n\t\tcase 'SET_VOICES': {\r\n\t\t\treturn { ...state, voices: payload };\r\n\t\t}\r\n\t\tcase 'SET_ELAPSED_TIME': {\r\n\t\t\treturn { ...state, elapsedTime: payload };\r\n\t\t}\r\n\t\tcase 'SET_DURATION': {\r\n\t\t\treturn { ...state, duration: payload };\r\n\t\t}\r\n\t\tcase 'SET_NUMBER_OF_WORDS': {\r\n\t\t\treturn { ...state, numberOfWords: payload };\r\n\t\t}\r\n\t\tcase 'SET_CURRENT_WORD_INDEX': {\r\n\t\t\treturn { ...state, currentWordIndex: payload };\r\n\t\t}\r\n\t\tcase 'CHANGE_SETTINGS': {\r\n\t\t\treturn { ...state, settings: { ...state.settings, ...payload } };\r\n\t\t}\r\n\t\tcase 'CHANGE_OPTIONS': {\r\n\t\t\treturn { ...state, options: { ...state.options, ...payload } };\r\n\t\t}\r\n\t\tcase 'CHANGE_HIGHLIGHT_STYLE': {\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\thighlightStyle: { ...state.highlightStyle, ...payload },\r\n\t\t\t};\r\n\t\t}\r\n\t\tdefault:\r\n\t\t\treturn { ...state };\r\n\t}\r\n};\r\n","import { useContext } from 'react';\r\nimport { StoreContext, ReaderContext, MainPropsContext } from './contexts';\r\nimport { IStoreContext, IReaderContext, IMainPropsContext } from './types';\r\n\r\nexport const useStore = (): IStoreContext => {\r\n\tconst store = useContext(StoreContext);\r\n\treturn store as IStoreContext;\r\n};\r\n\r\nexport const useReader = (): IReaderContext => {\r\n\tconst reader = useContext(ReaderContext);\r\n\treturn reader as IReaderContext;\r\n};\r\n\r\nexport const useMainProps = (): IMainPropsContext => {\r\n\tconst mainProps = useContext(MainPropsContext);\r\n\treturn mainProps as IMainPropsContext;\r\n};\r\n","import React, { FC, useRef, useReducer } from 'react';\r\nimport { SpeechSynth } from 'lib';\r\nimport { rootReducer, globalState } from 'store';\r\nimport {\r\n\tsetIsReading,\r\n\tsetElapsedTime,\r\n\tsetCurrentWordIndex,\r\n\tchangeSettings,\r\n\tchangeOptions,\r\n\tchangeHighlightStyle,\r\n} from 'store/actions';\r\nimport { MainPropsContext, ReaderContext, StoreContext } from './contexts';\r\nimport {\r\n\tIMainPropsProviderProps,\r\n\tIReaderProviderProps,\r\n\tIStoreProviderProps,\r\n} from './types';\r\nimport { useStore, useMainProps } from './hooks';\r\n\r\n/* Provides the main props */\r\n\r\nexport const MainPropsProvider: FC<IMainPropsProviderProps> = ({\r\n\tvalue,\r\n\tchildren,\r\n}) => {\r\n\treturn (\r\n\t\t<MainPropsContext.Provider value={value}>\r\n\t\t\t{children}\r\n\t\t</MainPropsContext.Provider>\r\n\t);\r\n};\r\n\r\n/* Provides the reader instance */\r\n\r\nexport const ReaderProvider: FC<IReaderProviderProps> = ({ children }) => {\r\n\tconst { dispatch } = useStore();\r\n\tconst { textContainer, options, styleOptions } = useMainProps();\r\n\r\n\tconst readerRef = useRef<SpeechSynth>(\r\n\t\tnew SpeechSynth(textContainer, {\r\n\t\t\t...options,\r\n\t\t\tcolor1: styleOptions?.highlightColor1 || '#DEE',\r\n\t\t\tcolor2: styleOptions.highlightColor2 || '#9DE',\r\n\t\t\tonStart: (reader: SpeechSynth) => {\r\n\t\t\t\tconsole.log('Start');\r\n\t\t\t\tdispatch(setIsReading(reader.state.isReading));\r\n\t\t\t},\r\n\t\t\tonPause: (reader: SpeechSynth) => {\r\n\t\t\t\tconsole.log('Pause');\r\n\t\t\t\tdispatch(setIsReading(reader.state.isReading));\r\n\t\t\t},\r\n\t\t\tonResume: (reader: SpeechSynth) => {\r\n\t\t\t\tconsole.log('Resume');\r\n\t\t\t\tdispatch(setIsReading(reader.state.isReading));\r\n\t\t\t},\r\n\t\t\tonReset: (reader: SpeechSynth) => {\r\n\t\t\t\tconsole.log('Reset Event called', reader.state.elapsedTime);\r\n\t\t\t\tdispatch(setIsReading(reader.state.isReading));\r\n\t\t\t\tdispatch(setElapsedTime(reader.state.elapsedTime));\r\n\t\t\t\tdispatch(setCurrentWordIndex(reader.state.currentWordIndex));\r\n\t\t\t},\r\n\t\t\tonEnd: (reader: SpeechSynth) => {\r\n\t\t\t\tconsole.log('End');\r\n\t\t\t\treader.reset();\r\n\t\t\t},\r\n\t\t\tonBoundary: (reader: SpeechSynth, e: Event) => {\r\n\t\t\t\t// console.log('Boundary event');\r\n\t\t\t},\r\n\t\t\tonSeek: (reader: SpeechSynth) => {\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\t'Index inside the seek event listener',\r\n\t\t\t\t\treader.state,\r\n\t\t\t\t\treader.state.currentWordIndex\r\n\t\t\t\t);\r\n\t\t\t\tdispatch(setCurrentWordIndex(reader.state.currentWordIndex));\r\n\t\t\t},\r\n\t\t\tonTimeTick: (reader: SpeechSynth) => {\r\n\t\t\t\tdispatch(setElapsedTime(reader.state.elapsedTime));\r\n\t\t\t},\r\n\t\t\tonWordClick: (reader: SpeechSynth, e: MouseEvent) => {\r\n\t\t\t\tconst target: HTMLElement = e.target as HTMLElement;\r\n\t\t\t\tconst idx: number = +(target.dataset.id as string);\r\n\t\t\t\treader?.seekTo(idx);\r\n\t\t\t},\r\n\t\t\tonSettingsChange: (reader: SpeechSynth) => {\r\n\t\t\t\tconsole.log('Settings change');\r\n\t\t\t\tdispatch(changeSettings(reader.settings));\r\n\t\t\t},\r\n\t\t\tonOptionsChange: (reader: SpeechSynth) => {\r\n\t\t\t\tconsole.log('Options change', reader.options);\r\n\t\t\t\tdispatch(changeOptions(reader.options));\r\n\t\t\t},\r\n\t\t\tonStyleChange: (reader: SpeechSynth) => {\r\n\t\t\t\tconsole.log('Style change');\r\n\t\t\t\tdispatch(changeHighlightStyle(reader.style));\r\n\t\t\t},\r\n\t\t})\r\n\t);\r\n\r\n\treturn (\r\n\t\t<ReaderContext.Provider value={{ reader: readerRef.current }}>\r\n\t\t\t{children}\r\n\t\t</ReaderContext.Provider>\r\n\t);\r\n};\r\n\r\n/* Provides the store */\r\n\r\nexport const StoreProvider: FC<IStoreProviderProps> = ({ children }) => {\r\n\tconst [state, dispatch] = useReducer(rootReducer, globalState);\r\n\r\n\treturn (\r\n\t\t<StoreContext.Provider value={{ state, dispatch }}>\r\n\t\t\t{children}\r\n\t\t</StoreContext.Provider>\r\n\t);\r\n};\r\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import React, { FC } from 'react';\r\nimport { AiFillFastBackward } from '@react-icons/all-files/ai/AiFillFastBackward';\r\nimport { AiFillFastForward } from '@react-icons/all-files/ai/AiFillFastForward';\r\nimport { AiFillPlayCircle } from '@react-icons/all-files/ai/AiFillPlayCircle';\r\nimport { AiFillPauseCircle } from '@react-icons/all-files/ai/AiFillPauseCircle';\r\nimport { BiReset } from '@react-icons/all-files/bi/BiReset';\r\nimport { IMainControlsProps } from './types';\r\nimport { setIsLoading } from 'store/actions';\r\nimport { useReader, useStore } from 'contexts';\r\nimport styles from './styles.module.css';\r\n\r\nconst MainControls: FC<IMainControlsProps> = () => {\r\n\tconst { reader } = useReader();\r\n\tconst { state, dispatch } = useStore();\r\n\tconst { isReading, isLoading, isMinimized } = state;\r\n\r\n\tconst handleTextReadPlay = () => {\r\n\t\tif (reader?.isPaused()) reader?.resume();\r\n\t\telse\r\n\t\t\treader?.play('start').then(() => {\r\n\t\t\t\tdispatch(setIsLoading(false));\r\n\t\t\t});\r\n\t};\r\n\r\n\tconst handleTextReadPause = () => {\r\n\t\treader?.pause();\r\n\t};\r\n\r\n\tconst handleReset = () => {\r\n\t\treader?.reset();\r\n\t};\r\n\r\n\tconst handleFastBackward = () => {\r\n\t\tif (!reader) return;\r\n\t\tif (reader?.options.isChunksModeOn) {\r\n\t\t\tif (reader.state.currentChunkIndex - 1 >= 0)\r\n\t\t\t\treader.seekTo(\r\n\t\t\t\t\treader.state.chunksArray[reader.state.currentChunkIndex - 1]\r\n\t\t\t\t\t\t.start\r\n\t\t\t\t);\r\n\t\t} else if (reader.state.currentWordIndex - 1 >= 0)\r\n\t\t\treader.seekTo(reader.state.currentWordIndex - 1);\r\n\t};\r\n\r\n\tconst handleFastForward = () => {\r\n\t\tif (!reader) return;\r\n\r\n\t\tif (reader?.options.isChunksModeOn) {\r\n\t\t\tif (\r\n\t\t\t\treader.state.currentChunkIndex + 1 <\r\n\t\t\t\treader.state.chunksArray.length\r\n\t\t\t)\r\n\t\t\t\t/* Go to the next chunk */\r\n\t\t\t\treader.seekTo(\r\n\t\t\t\t\treader.state.chunksArray[reader.state.currentChunkIndex + 1]\r\n\t\t\t\t\t\t.start\r\n\t\t\t\t);\r\n\t\t} else if (\r\n\t\t\treader.state.currentWordIndex + 1 <=\r\n\t\t\t(reader.state.wholeTextArray.length as number)\r\n\t\t)\r\n\t\t\treader.seekTo(reader.state.currentWordIndex + 1);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tclassName={`${styles.container} ${\r\n\t\t\t\tisMinimized ? styles.minimized : styles.notMinimized\r\n\t\t\t}`}\r\n\t\t>\r\n\t\t\t<AiFillFastBackward\r\n\t\t\t\tclassName={`${styles.button} ${\r\n\t\t\t\t\tisLoading ? styles.loading : styles.notLoading\r\n\t\t\t\t}`}\r\n\t\t\t\ttitle=\"Fast backward\"\r\n\t\t\t\tonDoubleClick={(e) => e.preventDefault()}\r\n\t\t\t\tonPointerDown={handleFastBackward}\r\n\t\t\t/>\r\n\r\n\t\t\t{isReading ? (\r\n\t\t\t\t<AiFillPauseCircle\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\tfontSize: '2em',\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tclassName={`${styles.button} ${\r\n\t\t\t\t\t\tisLoading ? styles.loading : styles.notLoading\r\n\t\t\t\t\t}`}\r\n\t\t\t\t\ttitle={'Pause'}\r\n\t\t\t\t\tonPointerDown={handleTextReadPause}\r\n\t\t\t\t/>\r\n\t\t\t) : (\r\n\t\t\t\t<AiFillPlayCircle\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\tfontSize: '2em',\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tclassName={`${styles.button} ${\r\n\t\t\t\t\t\tisLoading ? styles.loading : styles.notLoading\r\n\t\t\t\t\t}`}\r\n\t\t\t\t\ttitle={'Play'}\r\n\t\t\t\t\tonPointerDown={handleTextReadPlay}\r\n\t\t\t\t/>\r\n\t\t\t)}\r\n\r\n\t\t\t<AiFillFastForward\r\n\t\t\t\ttitle=\"Fast forward\"\r\n\t\t\t\tclassName={`${styles.button} ${\r\n\t\t\t\t\tisLoading ? styles.loading : styles.notLoading\r\n\t\t\t\t}`}\r\n\t\t\t\tonPointerDown={handleFastForward}\r\n\t\t\t/>\r\n\t\t\t<BiReset\r\n\t\t\t\tclassName={styles.reset}\r\n\t\t\t\ttitle=\"reset\"\r\n\t\t\t\tonClick={handleReset}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default MainControls;\r\n","// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.FiMaximize = function FiMaximize (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":\"2\",\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3\"}}]})(props);\n};\n","// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.FiMinimize = function FiMinimize (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":\"2\",\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3\"}}]})(props);\n};\n","// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.MdClose = function MdClose (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"viewBox\":\"0 0 24 24\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"}}]})(props);\n};\n","import React, { FC } from 'react';\r\nimport { IWindowControlsProps } from './types';\r\nimport { FiMaximize } from '@react-icons/all-files/fi/FiMaximize';\r\nimport { FiMinimize } from '@react-icons/all-files/fi/FiMinimize';\r\nimport { MdClose } from '@react-icons/all-files/md/MdClose';\r\nimport { setIsMinimized, setIsVisible } from 'store/actions';\r\nimport { useReader, useStore } from 'contexts';\r\nimport styles from './styles.module.css';\r\n\r\nconst WindowControls: FC<IWindowControlsProps> = () => {\r\n\tconst { reader } = useReader();\r\n\tconst { state, dispatch } = useStore();\r\n\tconst { isMinimized } = state;\r\n\r\n\tconst handleHideReader = () => {\r\n\t\tdispatch(setIsVisible(false));\r\n\t\treader?.reset();\r\n\t};\r\n\r\n\tconst handleMinimizeReader = () => {\r\n\t\tdispatch(setIsMinimized(true));\r\n\t};\r\n\r\n\tconst handleMaximizeReader = () => {\r\n\t\tdispatch(setIsMinimized(false));\r\n\t};\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div\r\n\t\t\t\tstyle={{ position: 'absolute', top: '2px', right: '3px' }}\r\n\t\t\t\ttitle={'Close'}\r\n\t\t\t\tclassName={styles.button}\r\n\t\t\t\tonPointerDown={handleHideReader}\r\n\t\t\t>\r\n\t\t\t\t<MdClose title=\"Close\" />\r\n\t\t\t</div>\r\n\t\t\t{/* Minimize button */}\r\n\t\t\t<div\r\n\t\t\t\tstyle={{ position: 'absolute', top: '2px', right: '24px' }}\r\n\t\t\t\ttitle={isMinimized ? 'Maximize' : 'Minimize'}\r\n\t\t\t\tclassName={styles.button}\r\n\t\t\t\tonPointerDown={\r\n\t\t\t\t\tisMinimized ? handleMaximizeReader : handleMinimizeReader\r\n\t\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t{isMinimized ? <FiMaximize /> : <FiMinimize />}\r\n\t\t\t</div>\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default WindowControls;\r\n","import React, { FC } from 'react';\r\nimport { ISeekBarProps } from './types';\r\nimport { useReader, useStore } from 'contexts';\r\nimport styles from './styles.module.css';\r\nimport { Utils } from 'lib';\r\n\r\nconst SeekBar: FC<ISeekBarProps> = () => {\r\n\tconst { reader } = useReader();\r\n\tconst { state } = useStore();\r\n\r\n\tconst {\r\n\t\telapsedTime,\r\n\t\tnumberOfWords,\r\n\t\tcurrentWordIndex,\r\n\t\tisMinimized,\r\n\t\tduration,\r\n\t} = state;\r\n\r\n\tconst debouncedHandleManualSeek = Utils.debounce(\r\n\t\treader?.seekTo.bind(reader) || Function,\r\n\t\t3\r\n\t);\r\n\r\n\tconst handleManualSeek = (e) => {\r\n\t\tconst value = +(e.target as HTMLInputElement).value;\r\n\t\tdebouncedHandleManualSeek(value);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tclassName={`${styles.container} ${isMinimized && styles.minimized}`}\r\n\t\t>\r\n\t\t\t<h5 className={styles.time}>{Utils.formatMsToTime(elapsedTime)}</h5>\r\n\r\n\t\t\t<input\r\n\t\t\t\tclassName={styles.seekbar}\r\n\t\t\t\ttype=\"range\"\r\n\t\t\t\tmin=\"0\"\r\n\t\t\t\tmax={numberOfWords - 1}\r\n\t\t\t\tstep=\"1\"\r\n\t\t\t\tvalue={currentWordIndex}\r\n\t\t\t\tonChange={handleManualSeek}\r\n\t\t\t/>\r\n\t\t\t<h5\r\n\t\t\t\tstyle={{ left: 'auto', right: '-15px' }}\r\n\t\t\t\tclassName={styles.time}\r\n\t\t\t>\r\n\t\t\t\t{Utils.formatMsToTime(duration)}*\r\n\t\t\t</h5>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default SeekBar;\r\n","import { EventHandler, RefObject, useEffect, useRef } from 'react';\r\n\r\nexport const useOnClickOutside = (\r\n\tref: RefObject<HTMLElement>,\r\n\thandler: (e: Event) => void\r\n): void => {\r\n\tuseEffect(\r\n\t\t() => {\r\n\t\t\tconst listener: EventHandler<any> = (event) => {\r\n\t\t\t\t// Do nothing if clicking ref's element or descendent elements\r\n\t\t\t\tif (!ref.current || ref.current.contains(event?.target)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\thandler(event);\r\n\t\t\t};\r\n\t\t\tdocument.addEventListener('mousedown', listener);\r\n\t\t\tdocument.addEventListener('touchstart', listener);\r\n\t\t\treturn () => {\r\n\t\t\t\tdocument.removeEventListener('mousedown', listener);\r\n\t\t\t\tdocument.removeEventListener('touchstart', listener);\r\n\t\t\t};\r\n\t\t},\r\n\t\t// Add ref and handler to effect dependencies\r\n\t\t// It's worth noting that because passed in handler is a new ...\r\n\t\t// ... function on every render that will cause this effect ...\r\n\t\t// ... callback/cleanup to run every render. It's not a big deal ...\r\n\t\t// ... but to optimize you can wrap handler in useCallback before ...\r\n\t\t// ... passing it into this hook.\r\n\t\t[ref, handler]\r\n\t);\r\n};\r\n\r\nexport const useIsFirstRender = () => {\r\n\tconst ref = useRef(true);\r\n\tuseEffect(() => {\r\n\t\tref.current = false;\r\n\t}, []);\r\n\treturn ref.current;\r\n};\r\n","import React, { FC } from 'react';\r\nimport styles from './styles.module.css';\r\n\r\nexport interface IButtonProps {\r\n\tchildren?: JSX.Element | string;\r\n\t[key: string]: any;\r\n}\r\n\r\n/* React Components */\r\n\r\nexport const Button: FC<IButtonProps> = ({ children, ...props }) => {\r\n\treturn (\r\n\t\t<div className={styles.button} {...props}>\r\n\t\t\t{children}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Button;\r\n","import React, { FC, useState, useRef, useCallback } from 'react';\r\nimport { useOnClickOutside } from '../../hooks/index';\r\nimport Button from './Button';\r\nimport { ICustomSelectProps } from './types';\r\nimport styles from './styles.module.css';\r\n\r\nconst CustomSelect: FC<ICustomSelectProps> = ({\r\n\toptions,\r\n\tvalue,\r\n\ttitle,\r\n\tonChange,\r\n\tstyle,\r\n\t...props\r\n}) => {\r\n\tconst [showOptions, setShowOptions] = useState(false);\r\n\tconst ref = useRef(null);\r\n\r\n\tconst show = () => {\r\n\t\tsetShowOptions(true);\r\n\t};\r\n\r\n\tconst hide = useCallback(() => {\r\n\t\tsetShowOptions(false);\r\n\t}, []);\r\n\r\n\tconst onOptionClick = (val: string) => {\r\n\t\tonChange(val);\r\n\t\thide();\r\n\t};\r\n\r\n\tuseOnClickOutside(ref, hide);\r\n\r\n\treturn (\r\n\t\t<div className={styles.container} {...props}>\r\n\t\t\t<Button type=\"button\" onClick={show}>\r\n\t\t\t\t{options.find((o) => o.value === value)?.name}\r\n\t\t\t</Button>\r\n\t\t\t<div\r\n\t\t\t\tref={ref}\r\n\t\t\t\tclassName={`${styles.optionsContainer} ${\r\n\t\t\t\t\tshowOptions && styles.visible\r\n\t\t\t\t}`}\r\n\t\t\t\tonPointerDown={hide}\r\n\t\t\t>\r\n\t\t\t\t{options.map((opt) => (\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tkey={opt.value}\r\n\t\t\t\t\t\tonPointerDown={(e) => {\r\n\t\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\t\tonOptionClick(opt.value);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{opt.name}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default CustomSelect;\r\n","// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.BiVolumeFull = function BiVolumeFull (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"viewBox\":\"0 0 24 24\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"d\":\"M16,21c3.527-1.547,5.999-4.909,5.999-9S19.527,4.547,16,3v2c2.387,1.386,3.999,4.047,3.999,7S18.387,17.614,16,19V21z\"}},{\"tag\":\"path\",\"attr\":{\"d\":\"M16 7v10c1.225-1.1 2-3.229 2-5S17.225 8.1 16 7zM4 17h2.697l5.748 3.832C12.612 20.943 12.806 21 13 21c.162 0 .324-.039.472-.118C13.797 20.708 14 20.369 14 20V4c0-.369-.203-.708-.528-.882-.324-.175-.72-.154-1.026.05L6.697 7H4C2.897 7 2 7.897 2 9v6C2 16.103 2.897 17 4 17zM4 9h3c.033 0 .061-.016.093-.019.064-.006.125-.02.188-.038.068-.021.131-.045.192-.078.026-.015.057-.017.082-.033L12 5.868v12.264l-4.445-2.964c-.025-.017-.056-.02-.082-.033-.061-.033-.123-.058-.19-.078-.064-.019-.126-.032-.192-.038C7.059 15.016 7.032 15 7 15H4V9z\"}}]})(props);\n};\n","import React, { ChangeEventHandler, FC } from 'react';\r\nimport { IGenericSliderProps } from './types';\r\nimport styles from './styles.module.css';\r\nimport { Utils } from 'lib';\r\n\r\nconst GenericSlider: FC<IGenericSliderProps> = ({\r\n\tdata,\r\n\tonChange,\r\n\ticon,\r\n\t...props\r\n}) => {\r\n\tconst debouncedOnChange = Utils.debounce(onChange, 5);\r\n\r\n\tconst handleChange: ChangeEventHandler = (e) => {\r\n\t\tconst value = +(e.target as HTMLInputElement).value;\r\n\t\tdebouncedOnChange(value);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className={styles.container} {...props}>\r\n\t\t\t{icon && <div className={styles.icon}>{icon}</div>}\r\n\t\t\t<input\r\n\t\t\t\tclassName={styles.slider}\r\n\t\t\t\tmin={data.min}\r\n\t\t\t\tmax={data.max}\r\n\t\t\t\tstep={data.step}\r\n\t\t\t\ttype=\"range\"\r\n\t\t\t\tvalue={data.value}\r\n\t\t\t\tonChange={handleChange}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default GenericSlider;\r\n","// THIS FILE IS AUTO GENERATED\nvar GenIcon = require('../lib').GenIcon\nmodule.exports.FcSettings = function FcSettings (props) {\n  return GenIcon({\"tag\":\"svg\",\"attr\":{\"version\":\"1\",\"viewBox\":\"0 0 48 48\",\"enableBackground\":\"new 0 0 48 48\"},\"child\":[{\"tag\":\"path\",\"attr\":{\"fill\":\"#607D8B\",\"d\":\"M39.6,27.2c0.1-0.7,0.2-1.4,0.2-2.2s-0.1-1.5-0.2-2.2l4.5-3.2c0.4-0.3,0.6-0.9,0.3-1.4L40,10.8 c-0.3-0.5-0.8-0.7-1.3-0.4l-5,2.3c-1.2-0.9-2.4-1.6-3.8-2.2l-0.5-5.5c-0.1-0.5-0.5-0.9-1-0.9h-8.6c-0.5,0-1,0.4-1,0.9l-0.5,5.5 c-1.4,0.6-2.7,1.3-3.8,2.2l-5-2.3c-0.5-0.2-1.1,0-1.3,0.4l-4.3,7.4c-0.3,0.5-0.1,1.1,0.3,1.4l4.5,3.2c-0.1,0.7-0.2,1.4-0.2,2.2 s0.1,1.5,0.2,2.2L4,30.4c-0.4,0.3-0.6,0.9-0.3,1.4L8,39.2c0.3,0.5,0.8,0.7,1.3,0.4l5-2.3c1.2,0.9,2.4,1.6,3.8,2.2l0.5,5.5 c0.1,0.5,0.5,0.9,1,0.9h8.6c0.5,0,1-0.4,1-0.9l0.5-5.5c1.4-0.6,2.7-1.3,3.8-2.2l5,2.3c0.5,0.2,1.1,0,1.3-0.4l4.3-7.4 c0.3-0.5,0.1-1.1-0.3-1.4L39.6,27.2z M24,35c-5.5,0-10-4.5-10-10c0-5.5,4.5-10,10-10c5.5,0,10,4.5,10,10C34,30.5,29.5,35,24,35z\"}},{\"tag\":\"path\",\"attr\":{\"fill\":\"#455A64\",\"d\":\"M24,13c-6.6,0-12,5.4-12,12c0,6.6,5.4,12,12,12s12-5.4,12-12C36,18.4,30.6,13,24,13z M24,30 c-2.8,0-5-2.2-5-5c0-2.8,2.2-5,5-5s5,2.2,5,5C29,27.8,26.8,30,24,30z\"}}]})(props);\n};\n","import React, { ChangeEventHandler, FC, useMemo, useRef } from 'react';\r\nimport styles from './styles.module.css';\r\nimport { FcSettings } from '@react-icons/all-files/fc/FcSettings';\r\nimport { useReader, useStore } from 'contexts';\r\nimport { useOnClickOutside } from 'hooks';\r\nimport { setIsOptionsVisible } from 'store/actions';\r\nimport { IOptionsProps } from './types';\r\n\r\nconst Options: FC<IOptionsProps> = () => {\r\n\tconst ref = useRef(null);\r\n\tconst { reader } = useReader();\r\n\tconst { state, dispatch } = useStore();\r\n\r\n\tconst {\r\n\t\tisOptionsVisible,\r\n\t\toptions: {\r\n\t\t\tisChunksModeOn,\r\n\t\t\tisHighlightTextOn,\r\n\t\t\tisPreserveHighlighting,\r\n\t\t\tisUnderlinedOn,\r\n\t\t},\r\n\t} = state;\r\n\r\n\tconst showOptions = () => {\r\n\t\tdispatch(setIsOptionsVisible(true));\r\n\t};\r\n\r\n\tconst hideOptions = () => {\r\n\t\tdispatch(setIsOptionsVisible(false));\r\n\t};\r\n\t/* Options Handlers */\r\n\r\n\tconst options = useMemo(() => {\r\n\t\tconst handlePreserveHighlighting: ChangeEventHandler = (e) => {\r\n\t\t\tconst target = e.target as HTMLInputElement;\r\n\t\t\treader?.changeOptions({ isPreserveHighlighting: target.checked });\r\n\t\t};\r\n\r\n\t\tconst handleIsHighlightTextOn: ChangeEventHandler = (e) => {\r\n\t\t\tconst target = e.target as HTMLInputElement;\r\n\t\t\treader?.changeOptions({ isHighlightTextOn: target.checked });\r\n\t\t};\r\n\r\n\t\tconst handleIsChunksModeOn: ChangeEventHandler = (e) => {\r\n\t\t\tif (reader?.state.isMobile) return; // Disable this option for mobile devices\r\n\t\t\tconst target = e.target as HTMLInputElement;\r\n\t\t\treader?.changeOptions({ isChunksModeOn: target.checked });\r\n\t\t};\r\n\r\n\t\tconst handleIsUnderlinedOn: ChangeEventHandler = (e) => {\r\n\t\t\tconst target = e.target as HTMLInputElement;\r\n\t\t\tconsole.log('Is underlined on', target.checked);\r\n\t\t\treader?.changeOptions({ isUnderlinedOn: target.checked });\r\n\t\t};\r\n\r\n\t\treturn [\r\n\t\t\t{\r\n\t\t\t\tid: 'highlight-option',\r\n\t\t\t\tlabel: 'Enable Highlighting',\r\n\t\t\t\tvalue: isHighlightTextOn,\r\n\t\t\t\thandler: handleIsHighlightTextOn,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: 'preserve-option',\r\n\t\t\t\tlabel: 'Preserve Highlighting',\r\n\t\t\t\tvalue: isPreserveHighlighting,\r\n\t\t\t\thandler: handlePreserveHighlighting,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: 'chunksmode-option',\r\n\t\t\t\tlabel: 'Enable Chunks Mode',\r\n\t\t\t\tvalue: isChunksModeOn,\r\n\t\t\t\thandler: handleIsChunksModeOn,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tid: 'underlined-option',\r\n\t\t\t\tlabel: 'Enable Underline',\r\n\t\t\t\tvalue: isUnderlinedOn,\r\n\t\t\t\thandler: handleIsUnderlinedOn,\r\n\t\t\t},\r\n\t\t];\r\n\t}, [\r\n\t\tisChunksModeOn,\r\n\t\tisHighlightTextOn,\r\n\t\tisPreserveHighlighting,\r\n\t\tisUnderlinedOn,\r\n\t\treader,\r\n\t]);\r\n\r\n\tuseOnClickOutside(ref, hideOptions);\r\n\r\n\treturn (\r\n\t\t<div className={styles.container} ref={ref}>\r\n\t\t\t<FcSettings className={styles.icon} onPointerDown={showOptions} />\r\n\t\t\t<div\r\n\t\t\t\tclassName={`${styles.overlayContainer} ${\r\n\t\t\t\t\tisOptionsVisible && styles.visible\r\n\t\t\t\t}`}\r\n\t\t\t\tonPointerDown={hideOptions}\r\n\t\t\t>\r\n\t\t\t\t{options.map((o) => (\r\n\t\t\t\t\t<label\r\n\t\t\t\t\t\tkey={o.id}\r\n\t\t\t\t\t\thtmlFor={o.id}\r\n\t\t\t\t\t\tonPointerDown={(e) => e.stopPropagation()}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\tid={o.id}\r\n\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\tchecked={o.value}\r\n\t\t\t\t\t\t\tonChange={o.handler}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<h5>{o.label}</h5>\r\n\t\t\t\t\t</label>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Options;\r\n","import React, { FC } from 'react';\r\nimport { ISecondaryControlsProps } from './types';\r\nimport CustomSelect from 'components/CustomSelect/CustomSelect';\r\nimport { BiVolumeFull } from '@react-icons/all-files/bi/BiVolumeFull';\r\nimport { setDuration } from 'store/actions';\r\nimport { useReader, useStore } from 'contexts';\r\nimport styles from './styles.module.css';\r\nimport GenericSlider from 'components/GenericSlider/GenericSlider';\r\nimport Options from 'components/Options/Options';\r\n\r\nconst palette = [\r\n\t{ name: 'Purple', value: '#98AFC7' },\r\n\t{ name: 'Green', value: 'green' },\r\n\t{ name: 'Yellow', value: 'yellow' },\r\n];\r\n\r\nconst SecondaryControls: FC<ISecondaryControlsProps> = () => {\r\n\tconst { reader } = useReader();\r\n\tconst { state, dispatch } = useStore();\r\n\r\n\tconst {\r\n\t\tvoices,\r\n\t\tsettings: { voiceURI, volume, rate },\r\n\t\thighlightStyle,\r\n\t} = state;\r\n\r\n\t/* Settings Handlers */\r\n\r\n\tconst handleRateChange = (value: string) => {\r\n\t\treader?.changeSettings({ rate: +value });\r\n\t\tdispatch(setDuration(reader?.state.duration || 0));\r\n\t};\r\n\r\n\tconst handleVoiceChange = (value: string) => {\r\n\t\treader?.changeSettings({ voiceURI: value });\r\n\t};\r\n\r\n\tconst handleVolumeChange = (value: number) => {\r\n\t\treader?.changeSettings({ volume: value });\r\n\t};\r\n\r\n\tconst handleHighlightColorChange = (value: string) => {\r\n\t\treader?.changeStyle({ type: 'highlight-color', value });\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className={styles.container}>\r\n\t\t\t<div className={styles.optionsWrapper1}>\r\n\t\t\t\t{/* Rate setting button */}\r\n\t\t\t\t<CustomSelect\r\n\t\t\t\t\tname=\"rate\"\r\n\t\t\t\t\toptions={[\r\n\t\t\t\t\t\t{ value: '0.5', name: '0.5x' },\r\n\t\t\t\t\t\t{ value: '0.75', name: '0.75x' },\r\n\t\t\t\t\t\t{ value: '1', name: '1x' },\r\n\t\t\t\t\t\t{ value: '1.25', name: '1.25x' },\r\n\t\t\t\t\t\t{ value: '1.5', name: '1.5x' },\r\n\t\t\t\t\t\t{ value: '2', name: '2x' },\r\n\t\t\t\t\t]}\r\n\t\t\t\t\tonChange={handleRateChange}\r\n\t\t\t\t\tvalue={rate.toString()}\r\n\t\t\t\t\tdefaultValue=\"1\"\r\n\t\t\t\t\ttitle=\"Rate\"\r\n\t\t\t\t/>\r\n\t\t\t\t{/* Voice setting button */}\r\n\t\t\t\t<CustomSelect\r\n\t\t\t\t\tname=\"voice\"\r\n\t\t\t\t\toptions={voices}\r\n\t\t\t\t\tonChange={handleVoiceChange}\r\n\t\t\t\t\tvalue={voiceURI || ''}\r\n\t\t\t\t\tdefaultValue=\"1\"\r\n\t\t\t\t\ttitle=\"Voices\"\r\n\t\t\t\t/>\r\n\t\t\t\t{/* Reader Options Button */}\r\n\t\t\t\t<Options />\r\n\t\t\t\t<CustomSelect\r\n\t\t\t\t\tname=\"palette\"\r\n\t\t\t\t\toptions={palette}\r\n\t\t\t\t\tonChange={handleHighlightColorChange}\r\n\t\t\t\t\tvalue={highlightStyle.color1 || 'yellow'}\r\n\t\t\t\t\tdefaultValue=\"lavander\"\r\n\t\t\t\t\ttitle=\"Palette\"\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{/* <ImInfo\r\n\t\t\t\t\tstyle={{ marginLeft: '10px' }}\r\n\t\t\t\t\tclassName={styles.icon}\r\n\t\t\t\t\tonPointerDown={toggleSettings}\r\n\t\t\t\t/> */}\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className={styles.optionsWrapper2}>\r\n\t\t\t\t<GenericSlider\r\n\t\t\t\t\ticon={<BiVolumeFull />}\r\n\t\t\t\t\tonChange={handleVolumeChange}\r\n\t\t\t\t\tdata={{\r\n\t\t\t\t\t\tmin: '0.1',\r\n\t\t\t\t\t\tmax: '1',\r\n\t\t\t\t\t\tstep: '0.1',\r\n\t\t\t\t\t\tvalue: volume,\r\n\t\t\t\t\t\tunit: '%',\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default SecondaryControls;\r\n\r\n// \"The Sea's Symphony\"\r\n\r\n/* \r\nDeep in the ocean blue,\r\nWhere colorful fishes swim,\r\nThey sing a melody,\r\nA symphony within.\r\n\r\nThe whales and dolphins join in,\r\nTheir songs so grand and true,\r\nThe sea is alive, gives chillings,\r\nA symphony for me and you.\r\n\r\nThe coral reefs, the seaweed beds,\r\nAll play their part,\r\nThat's a real work of art.\r\n\r\nThe ocean is a treasure,\r\nWe must protect it still,\r\nFor the sea's symphony,\r\nIs a melody worth the thrill. \r\n\r\n*/\r\n","import { useReader, useStore, useMainProps } from 'contexts';\r\nimport { useMemo, useEffect } from 'react';\r\nimport {\r\n\tsetIsVisible,\r\n\tsetIsMinimized,\r\n\tsetIsLoading,\r\n\tchangeOptions,\r\n\tchangeSettings,\r\n\tsetDuration,\r\n\tsetNumberOfWords,\r\n\tsetVoices,\r\n\tchangeHighlightStyle,\r\n} from 'store/actions';\r\n\r\nexport const useBindTextReader = () => {\r\n\tconst { reader } = useReader();\r\n\tconst { state, dispatch } = useStore();\r\n\tconst { isMinimized, isVisible, isReading, isLoading } = state;\r\n\tconst { bindReader } = useMainProps();\r\n\r\n\tconst handlers = useMemo(\r\n\t\t() => ({\r\n\t\t\tshowReader: () => {\r\n\t\t\t\tdispatch(setIsVisible(true));\r\n\t\t\t},\r\n\t\t\thideReader: () => {\r\n\t\t\t\tdispatch(setIsVisible(false));\r\n\t\t\t},\r\n\t\t\tminimizeReader: () => {\r\n\t\t\t\tdispatch(setIsMinimized(true));\r\n\t\t\t},\r\n\t\t\tmaximizeReader: () => {\r\n\t\t\t\tdispatch(setIsMinimized(false));\r\n\t\t\t},\r\n\t\t\tplay: () => {\r\n\t\t\t\tif (reader?.isPaused()) reader?.resume();\r\n\t\t\t\telse\r\n\t\t\t\t\treader?.play('start').then(() => {\r\n\t\t\t\t\t\tdispatch(setIsLoading(false));\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tpause: () => reader?.pause(),\r\n\t\t}),\r\n\t\t[dispatch, reader]\r\n\t);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!bindReader || typeof bindReader !== 'function') return;\r\n\t\tconst exposedState = { isMinimized, isVisible, isReading, isLoading };\r\n\t\tbindReader(exposedState, handlers);\r\n\t}, [\r\n\t\tbindReader,\r\n\t\tdispatch,\r\n\t\thandlers,\r\n\t\tisLoading,\r\n\t\tisMinimized,\r\n\t\tisReading,\r\n\t\tisVisible,\r\n\t]);\r\n};\r\n\r\nexport const useInitializeReader = () => {\r\n\tconst { reader } = useReader();\r\n\tconst { dispatch } = useStore();\r\n\r\n\tuseEffect(() => {\r\n\t\t/* Reset browser active speech synth queue on refresh or new load */\r\n\r\n\t\twindow.speechSynthesis.cancel();\r\n\r\n\t\treader\r\n\t\t\t?.init()\r\n\t\t\t.then((reader) => {\r\n\t\t\t\tconst formattedVoices: IVoiceInfo[] = reader.state.voices?.map(\r\n\t\t\t\t\t(voice) => ({\r\n\t\t\t\t\t\tname: voice.name?.replace(\r\n\t\t\t\t\t\t\t/(Microsoft\\s)|(Online\\s)|(\\(Natural\\))|(\\s-.*$)/gm, // Display only the plain voice name\r\n\t\t\t\t\t\t\t''\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t\tvalue: voice.voiceURI,\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\r\n\t\t\t\t/* Synchronize UI state with reader initial state */\r\n\r\n\t\t\t\tdispatch(setVoices(formattedVoices));\r\n\t\t\t\tdispatch(setNumberOfWords(reader.state.numberOfWords));\r\n\t\t\t\tdispatch(setDuration(reader.state.duration));\r\n\r\n\t\t\t\tdispatch(changeSettings(reader.settings));\r\n\t\t\t\tdispatch(changeOptions(reader.options));\r\n\t\t\t\tdispatch(changeHighlightStyle(reader.style));\r\n\t\t\t})\r\n\t\t\t.catch((e) => console.log(e));\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, []);\r\n};\r\n\r\nexport const useSetCSSVAriables = () => {\r\n\tconst { styleOptions } = useMainProps();\r\n\r\n\tuseEffect(() => {\r\n\t\tfor (const entry of Object.entries(styleOptions))\r\n\t\t\tdocument.documentElement.style.setProperty(\r\n\t\t\t\t`--${entry[0]}`,\r\n\t\t\t\tentry[1]\r\n\t\t\t);\r\n\t}, [styleOptions]);\r\n};\r\n","import React, { FC } from 'react';\r\nimport { ITextReaderProps } from './types';\r\nimport MainControls from 'components/MainControls/MainControls';\r\nimport WindowControls from 'components/WindowControls/WindowControls';\r\nimport SeekBar from 'components/SeekBar/SeekBar';\r\nimport SecondaryControls from 'components/SecondaryControls/SecondaryControls';\r\nimport {\r\n\tuseBindTextReader,\r\n\tuseInitializeReader,\r\n\tuseSetCSSVAriables,\r\n} from './hooks';\r\nimport { useStore } from 'contexts';\r\nimport styles from './styles.module.css';\r\n\r\nconst TextReader: FC<ITextReaderProps> = () => {\r\n\tconst { state } = useStore();\r\n\tconst { isMinimized, isVisible } = state;\r\n\r\n\tuseSetCSSVAriables();\r\n\r\n\tuseBindTextReader();\r\n\r\n\tuseInitializeReader();\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tclassName={`${styles.container} ${isVisible && styles.visible} ${\r\n\t\t\t\tisMinimized && styles.minimized\r\n\t\t\t}`}\r\n\t\t>\r\n\t\t\t<WindowControls />\r\n\t\t\t<SeekBar />\r\n\t\t\t<MainControls />\r\n\t\t\t{/* Settings */}\r\n\t\t\t{!isMinimized && <SecondaryControls />}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default TextReader;\r\n","/* Providers */\r\n\r\nimport TextReader from 'components/TextReader/TextReader';\r\nimport { MainPropsProvider, StoreProvider, ReaderProvider } from 'contexts';\r\nimport { BindReader } from 'contexts/types';\r\nimport React, { FC, useCallback, useState } from 'react';\r\n\r\nexport interface IProps {\r\n\tchildren?: JSX.Element | string;\r\n\toptions: { language: string };\r\n\tstyleOptions: IStyleOptions;\r\n\ttextContainer: HTMLElement;\r\n\tbindReader?: BindReader;\r\n}\r\n\r\nconst App: FC<IProps> = ({\r\n\toptions,\r\n\tstyleOptions,\r\n\ttextContainer,\r\n\tbindReader,\r\n}) => {\r\n\treturn (\r\n\t\t<MainPropsProvider\r\n\t\t\tvalue={{\r\n\t\t\t\toptions,\r\n\t\t\t\tstyleOptions,\r\n\t\t\t\ttextContainer,\r\n\t\t\t\tbindReader,\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<StoreProvider>\r\n\t\t\t\t<ReaderProvider>\r\n\t\t\t\t\t<TextReader />\r\n\t\t\t\t</ReaderProvider>\r\n\t\t\t</StoreProvider>\r\n\t\t</MainPropsProvider>\r\n\t);\r\n};\r\n\r\nApp.defaultProps = {\r\n\toptions: {\r\n\t\tlanguage: 'en',\r\n\t},\r\n\tstyleOptions: {\r\n\t\tprimaryColor: '#00D',\r\n\t\tsecondaryColor: '#55F',\r\n\t\tbgColor: '#FFF',\r\n\t\ttextColor: '#222',\r\n\t\thighlightColor1: '#98AFC7',\r\n\t\thighlightColor2: '#737CA1',\r\n\t},\r\n};\r\n\r\nexport const useTextReader = () => {\r\n\tconst [handlers, setHandlers] = useState({});\r\n\tconst [state, setState] = useState({});\r\n\r\n\tconst bindReader = useCallback(\r\n\t\t(state, handlers) => {\r\n\t\t\tsetState(state);\r\n\t\t\tsetHandlers(handlers);\r\n\t\t},\r\n\t\t[setState, setHandlers]\r\n\t);\r\n\r\n\treturn { handlers, state, bindReader };\r\n};\r\n\r\nexport { SpeechSynth } from './lib';\r\n\r\nexport default App;\r\n"],"names":["DefaultContext","color","undefined","size","className","style","attr","IconContext","React","createContext","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","Tree2Element","tree","map","node","createElement","tag","key","child","IconBase","props","elem","conf","title","svgProps","computedSize","stroke","fill","strokeWidth","height","width","xmlns","children","Consumer","data","id","name","projectUrl","license","licenseUrl","GenIcon","require$$0","AiFillFastBackward_1","viewBox","d","AiFillFastForward_1","AiFillPlayCircle_1","AiFillPauseCircle_1","BiReset_1","createAction","type","payload","setIsReading","setIsMinimized","setIsVisible","setIsLoading","setIsOptionsVisible","setElapsedTime","setCurrentWordIndex","setDuration","changeSettings","changeOptions","changeHighlightStyle","StoreContext","MainPropsContext","ReaderContext","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","rejected","result","done","then","Utils","constructor","HTMLTags","static","test","navigator","userAgent","platform","window","innerWidth","devicePixelRatio","str","isNaN","isFinite","parseFloat","Date","fn","seconds","minutes","hours","secondsLeft","minutesLeft","Math","floor","toString","padStart","delay","timeout","args","clearTimeout","setTimeout","__join__","el","separator","SpeechSynth","EventEmitter","textContainer","language","color1","color2","onEnd","onStart","onPause","onResume","onReset","onBoundary","onTimeTick","onWordClick","onSeek","onSettingsChange","onOptionsChange","onStyleChange","onPlay","super","synth","speechSynthesis","utterance","SpeechSynthesisUtterance","timeoutRef","editTimeoutRef","events","handlers","settings","Proxy","pitch","voiceURI","rate","volume","set","obj","emit","Reflect","options","isHighlightTextOn","isChunksModeOn","isMobile","isPreserveHighlighting","isUnderlinedOn","state","voice","voices","isLoading","tagIndex","currentWord","currentWordIndex","currentWordProps","charIndex","charLength","highlightedWords","lastWordPosition","numberOfWords","wholeText","wholeTextArray","textRemaining","duration","elapsedTime","currentChunkIndex","chunksArray","isPaused","isReading","init","Array","getVoices","addHTMLHighlightTags","applyBasicStyleToWords","retrieveNumberOfWords","retrieveWholeText","getTextDuration","retrieveWholeTextArray","retrieveChunks","attachEventListenersToWords","addCustomEventListeners","initUtterance","console","log","text","lang","onboundary","handleBoundary","bind","onend","resetHighlight","handleChunkHighlighting","play","childNodes","forEach","nodeType","tagName","isEmptyString","textContent","isSpace","isWhitespaceChar","wrapper","document","split","filter","char","arr","isPunctuation","c","isSpecialReadableCharacter","isDot","isNumber","isWordWithNumbers","isPunctuationButDot","isWord","join","word","isSpecialUnreadableCharacter","isWordInsideAngularBrackets","newEl","createTextNode","appendChild","setAttribute","isZero","replaceChild","highlightChunk","idx","highlightText","currentPunctuationSymbol","chunks","previousEnd","trim","start","end","push","currentChunk","nextChunk","scrollTo","querySelector","scrollIntoView","behavior","block","timeCount","frequency","Error","clearTimeCount","resetTimeCount","previousWord","isValidDate","setInterval","startsWith","clearInterval","wordIndex","wordToHighlight","position","getBoundingClientRect","x","applyStyleToWord","backgroundColor","boxShadow","textDecoration","changeChunkMode","getCurrentChunkText","getRemainingText","restart","handler","isFunction","on","selector","querySelectorAll","addEventListener","slice","transition","getAverageTextElapsedTime","textArray","_text","delayRestart","cancel","pause","v","entry","entries","changeStyle","w","seekTo","chunk","find","speak","onstart","resume","reset","propsToReset","globalState","highlightStyle","isMinimized","isVisible","isOptionsVisible","rootReducer","action","useStore","useContext","useReader","useMainProps","MainPropsProvider","Provider","ReaderProvider","dispatch","styleOptions","readerRef","useRef","highlightColor1","highlightColor2","reader","target","dataset","current","StoreProvider","useReducer","styleInject","css","ref","insertAt","head","getElementsByTagName","firstChild","insertBefore","styleSheet","cssText","MainControls","styles","AiFillFastBackward","onDoubleClick","preventDefault","onPointerDown","AiFillPauseCircle","fontSize","AiFillPlayCircle","AiFillFastForward","BiReset","onClick","FiMaximize_1","strokeLinecap","strokeLinejoin","FiMinimize_1","MdClose_1","WindowControls","Fragment","top","right","MdClose","FiMaximize","FiMinimize","SeekBar","debouncedHandleManualSeek","debounce","Function","formatMsToTime","min","max","onChange","left","useOnClickOutside","useEffect","listener","event","contains","removeEventListener","Button","_a","CustomSelect","showOptions","setShowOptions","useState","hide","useCallback","_b","o","opt","val","stopPropagation","BiVolumeFull_1","GenericSlider","icon","debouncedOnChange","FcSettings_1","version","enableBackground","Options","hideOptions","useMemo","label","checked","FcSettings","htmlFor","palette","SecondaryControls","defaultValue","BiVolumeFull","unit","useInitializeReader","formattedVoices","replace","setNumberOfWords","catch","TextReader","documentElement","setProperty","useSetCSSVAriables","bindReader","showReader","hideReader","minimizeReader","maximizeReader","useBindTextReader","App","defaultProps","primaryColor","secondaryColor","bgColor","textColor","setHandlers","setState"],"mappings":"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"}